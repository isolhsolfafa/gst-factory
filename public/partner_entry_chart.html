
    <!DOCTYPE html>
    <html lang="ko">
    <head>
      <meta charset="UTF-8">
      <title>협력사 출입 대시보드</title>
      <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
      <style>
        .company-table { display: none; margin-top: 30px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #f0f0f0; }
      </style>
    </head>
    <body>
    <div id="bar-chart" style="width: 100%; height: 400px;"></div>
    
        <div id="BAT-table" class="company-table" style="display:none;">
            <h3>BAT 근무자 목록</h3>
            <table border="1" style="width:350px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th></tr>
            <tr><td>간연웅</td><td>공장</td><td>7시간 9분</td></tr><tr><td>김군</td><td>공장</td><td>7시간 7분</td></tr><tr><td>김원동</td><td>공장</td><td>2025. 6. 4 오전 7:43:09 (퇴근 미체크)</td></tr><tr><td>김춘동</td><td>공장</td><td>2025. 6. 4 오전 8:21:24 (퇴근 미체크)</td></tr><tr><td>박종범</td><td>공장</td><td>7시간 29분</td></tr><tr><td>박호</td><td>공장</td><td>2025. 6. 4 오전 7:45:35 (퇴근 미체크)</td></tr><tr><td>배홍범</td><td>공장</td><td>7시간 13분</td></tr><tr><td>우미정</td><td>공장</td><td>6시간 46분</td></tr><tr><td>우미현</td><td>공장</td><td>2025. 6. 4 오후 5:00:22 (퇴근 미체크)</td></tr><tr><td>윤청용</td><td>공장</td><td>7시간 6분</td></tr><tr><td>전성환</td><td>공장</td><td>7시간 6분</td></tr><tr><td>정대한</td><td>공장</td><td>7시간 38분</td></tr><tr><td>정인규</td><td>공장</td><td>7시간 20분</td></tr><tr><td>조동래</td><td>공장</td><td>2025. 6. 4 오전 7:51:41 (퇴근 미체크)</td></tr><tr><td>채은철</td><td>공장</td><td>7시간 9분</td></tr><tr><td>최진우</td><td>공장</td><td>2025. 6. 4 오전 7:53:58 (퇴근 미체크)</td></tr><tr><td>허용길</td><td>공장</td><td>7시간 0분</td></tr><tr><td>허창학</td><td>공장</td><td>2025. 6. 4 오전 7:45:48 (퇴근 미체크)</td></tr><tr><td>홍사현</td><td>공장</td><td>7시간 6분</td></tr><tr><td>황호</td><td>공장</td><td>7시간 7분</td></tr>
            </table>
        </div>
        
        <div id="C&A-table" class="company-table" style="display:none;">
            <h3>C&A 근무자 목록</h3>
            <table border="1" style="width:350px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th></tr>
            <tr><td>김우람</td><td>본사</td><td>2025. 6. 4 오전 7:38:32 (퇴근 미체크)</td></tr><tr><td>김인욱</td><td>공장</td><td>7시간 31분</td></tr><tr><td>김태곤</td><td>본사</td><td>2025. 6. 4 오전 7:53:23 (퇴근 미체크)</td></tr><tr><td>박새벽</td><td>공장</td><td>7시간 20분</td></tr><tr><td>박수현</td><td>공장</td><td>7시간 31분</td></tr><tr><td>박은혜</td><td>공장</td><td>2025. 6. 4 오전 7:54:06 (퇴근 미체크)</td></tr><tr><td>백상걸</td><td>공장</td><td>7시간 2분</td></tr><tr><td>성길용</td><td>공장</td><td>7시간 17분</td></tr><tr><td>윤문빈</td><td>공장</td><td>7시간 19분</td></tr><tr><td>이성훈</td><td>공장</td><td>2025. 6. 4 오후 12:11:08 (퇴근 미체크)</td></tr><tr><td>이숙자</td><td>공장</td><td>2025. 6. 4 오전 7:46:54 (퇴근 미체크)</td></tr><tr><td>이우성</td><td>본사</td><td>2025. 6. 4 오전 7:54:25 (퇴근 미체크)</td></tr><tr><td>이태희</td><td>공장</td><td>2025. 6. 4 오전 8:07:56 (퇴근 미체크)</td></tr><tr><td>정용진</td><td>공장</td><td>7시간 19분</td></tr><tr><td>정지성</td><td>공장</td><td>7시간 19분</td></tr><tr><td>조성수</td><td>공장</td><td>7시간 19분</td></tr><tr><td>한상호</td><td>공장</td><td>2025. 6. 4 오전 7:55:08 (퇴근 미체크)</td></tr><tr><td>홍수희</td><td>본사</td><td>2025. 6. 4 오전 7:57:00 (퇴근 미체크)</td></tr>
            </table>
        </div>
        
        <div id="FNI-table" class="company-table" style="display:none;">
            <h3>FNI 근무자 목록</h3>
            <table border="1" style="width:350px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th></tr>
            <tr><td>권민수</td><td>공장</td><td>2025. 6. 4 오전 7:31:18 (퇴근 미체크)</td></tr><tr><td>김용수</td><td>공장</td><td>2025. 6. 4 오전 7:47:45 (퇴근 미체크)</td></tr><tr><td>박연파</td><td>공장</td><td>2025. 6. 4 오전 6:50:17 (퇴근 미체크)</td></tr><tr><td>박주성</td><td>공장</td><td>2025. 6. 4 오전 7:28:24 (퇴근 미체크)</td></tr><tr><td>박천일</td><td>공장</td><td>2025. 6. 4 오전 7:52:34 (퇴근 미체크)</td></tr><tr><td>박춘광</td><td>공장</td><td>2025. 6. 4 오전 7:29:35 (퇴근 미체크)</td></tr><tr><td>서명환</td><td>공장</td><td>2025. 6. 4 오전 7:06:23 (퇴근 미체크)</td></tr><tr><td>서정원</td><td>공장</td><td>2025. 6. 4 오전 7:51:35 (퇴근 미체크)</td></tr><tr><td>손국권</td><td>공장</td><td>2025. 6. 4 오전 7:53:28 (퇴근 미체크)</td></tr><tr><td>안유성</td><td>공장</td><td>2025. 6. 4 오전 7:49:11 (퇴근 미체크)</td></tr><tr><td>오동혁</td><td>공장</td><td>2025. 6. 4 오전 8:09:52 (퇴근 미체크)</td></tr><tr><td>유승민</td><td>공장</td><td>2025. 6. 4 오전 7:48:55 (퇴근 미체크)</td></tr><tr><td>윤광성</td><td>공장</td><td>2025. 6. 4 오전 7:10:23 (퇴근 미체크)</td></tr><tr><td>윤석우</td><td>공장</td><td>2025. 6. 4 오전 7:13:57 (퇴근 미체크)</td></tr><tr><td>윤춘국</td><td>공장</td><td>2025. 6. 4 오전 7:54:20 (퇴근 미체크)</td></tr><tr><td>이승진</td><td>공장</td><td>2025. 6. 4 오전 7:44:56 (퇴근 미체크)</td></tr><tr><td>이영식</td><td>공장</td><td>2025. 6. 4 오후 1:44:24 (퇴근 미체크)</td></tr><tr><td>이영자</td><td>공장</td><td>2025. 6. 4 오전 7:51:11 (퇴근 미체크)</td></tr><tr><td>이은학</td><td>공장</td><td>2025. 6. 4 오전 7:35:59 (퇴근 미체크)</td></tr><tr><td>이일호</td><td>공장</td><td>2025. 6. 4 오전 7:34:46 (퇴근 미체크)</td></tr><tr><td>전우민</td><td>공장</td><td>2025. 6. 4 오전 7:22:32 (퇴근 미체크)</td></tr><tr><td>허문용</td><td>공장</td><td>2025. 6. 4 오전 7:47:06 (퇴근 미체크)</td></tr><tr><td>홍용천</td><td>공장</td><td>2025. 6. 4 오전 7:53:51 (퇴근 미체크)</td></tr><tr><td>황진충</td><td>공장</td><td>2025. 6. 4 오전 7:13:00 (퇴근 미체크)</td></tr>
            </table>
        </div>
        
        <div id="P&S-table" class="company-table" style="display:none;">
            <h3>P&S 근무자 목록</h3>
            <table border="1" style="width:350px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th></tr>
            <tr><td>강기준</td><td>공장</td><td>7시간 21분</td></tr><tr><td>김홍매</td><td>본사</td><td>6시간 54분</td></tr><tr><td>남민수</td><td>공장</td><td>2025. 6. 4 오전 8:02:56 (퇴근 미체크)</td></tr><tr><td>박광진</td><td>공장</td><td>9시간 43분</td></tr><tr><td>오권석</td><td>공장</td><td>2025. 6. 4 오전 8:03:49 (퇴근 미체크)</td></tr><tr><td>오해동</td><td>공장</td><td>7시간 24분</td></tr><tr><td>이옥매</td><td>본사</td><td>7시간 12분</td></tr><tr><td>이운</td><td>공장</td><td>2025. 6. 4 오전 8:41:32 (퇴근 미체크)</td></tr><tr><td>정민호</td><td>공장</td><td>2025. 6. 4 오전 8:00:28 (퇴근 미체크)</td></tr><tr><td>조홍연</td><td>본사</td><td>7시간 9분</td></tr><tr><td>최윤철</td><td>공장</td><td>7시간 51분</td></tr>
            </table>
        </div>
        
        <div id="TMS(E)-table" class="company-table" style="display:none;">
            <h3>TMS(E) 근무자 목록</h3>
            <table border="1" style="width:350px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th></tr>
            <tr><td>공종필</td><td>공장</td><td>2025. 6. 4 오전 7:33:11 (퇴근 미체크)</td></tr><tr><td>김삼구</td><td>본사</td><td>7시간 19분</td></tr><tr><td>김상명</td><td>공장</td><td>2025. 6. 4 오전 7:56:02 (퇴근 미체크)</td></tr><tr><td>김재호</td><td>공장</td><td>2025. 6. 4 오전 7:32:11 (퇴근 미체크)</td></tr><tr><td>김주용</td><td>공장</td><td>2025. 6. 4 오전 7:30:48 (퇴근 미체크)</td></tr><tr><td>김준</td><td>공장</td><td>2025. 6. 4 오전 8:27:43 (퇴근 미체크)</td></tr><tr><td>김창조</td><td>공장</td><td>2025. 6. 4 오전 6:53:33 (퇴근 미체크)</td></tr><tr><td>김형석</td><td>본사</td><td>7시간 20분</td></tr><tr><td>노윤제</td><td>공장</td><td>2025. 6. 4 오전 8:21:20 (퇴근 미체크)</td></tr><tr><td>오세훈</td><td>본사</td><td>7시간 19분</td></tr><tr><td>오정석</td><td>본사</td><td>7시간 20분</td></tr><tr><td>우강</td><td>공장</td><td>2025. 6. 4 오전 8:27:49 (퇴근 미체크)</td></tr><tr><td>유민상</td><td>본사</td><td>7시간 18분</td></tr><tr><td>윤금봉</td><td>공장</td><td>2025. 6. 4 오전 8:43:36 (퇴근 미체크)</td></tr><tr><td>윤성구</td><td>본사</td><td>7시간 18분</td></tr><tr><td>이동구</td><td>본사</td><td>7시간 18분</td></tr><tr><td>이종광</td><td>공장</td><td>2025. 6. 4 오전 7:55:07 (퇴근 미체크)</td></tr><tr><td>이효주</td><td>본사</td><td>7시간 17분</td></tr><tr><td>전준룡</td><td>본사</td><td>7시간 18분</td></tr><tr><td>최광학</td><td>공장</td><td>2025. 6. 4 오전 6:58:10 (퇴근 미체크)</td></tr><tr><td>최선희</td><td>본사</td><td>7시간 20분</td></tr><tr><td>최이명</td><td>공장</td><td>2025. 6. 4 오전 7:56:27 (퇴근 미체크)</td></tr>
            </table>
        </div>
        
        <div id="TMS(M)-table" class="company-table" style="display:none;">
            <h3>TMS(M) 근무자 목록</h3>
            <table border="1" style="width:350px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th></tr>
            <tr><td>김경민</td><td>공장</td><td>7시간 21분</td></tr><tr><td>이대균</td><td>공장</td><td>2025. 6. 4 오전 8:11:12 (퇴근 미체크)</td></tr><tr><td>이동민</td><td>공장</td><td>9시간 26분</td></tr><tr><td>이선만</td><td>공장</td><td>2025. 6. 4 오전 7:56:33 (퇴근 미체크)</td></tr><tr><td>이성균</td><td>공장</td><td>2025. 6. 4 오전 8:12:00 (퇴근 미체크)</td></tr><tr><td>이용</td><td>공장</td><td>9시간 14분</td></tr><tr><td>지화</td><td>공장</td><td>9시간 17분</td></tr><tr><td>최동호</td><td>공장</td><td>2025. 6. 4 오전 6:45:11 (퇴근 미체크)</td></tr>
            </table>
        </div>
        
    <script>
      var data = [
        {
          x: ['FNI', 'TMS(E)', 'BAT', 'C&A', 'P&S', 'TMS(M)'],
          y: [24, 12, 20, 14, 8, 8],
          name: '공장 인원',
          type: 'bar',
          text: [24, 12, 20, 14, 8, 8],
          textposition: 'inside',
          marker: {color: ['#2ca02c', '#9467bd', '#1f77b4', '#ff7f0e', '#d62728', '#8c564b']},
          hovertext: ['퇴근 미체크: 권민수, 김용수, 박연파, 박주성, 박천일, 박춘광, 서명환, 서정원, 손국권, 안유성, 오동혁, 유승민, 윤광성, 윤석우, 윤춘국, 이승진, 이영식, 이영자, 이은학, 이일호, 전우민, 허문용, 홍용천, 황진충', '퇴근 미체크: 공종필, 김상명, 김재호, 김주용, 김준, 김창조, 노윤제, 우강, 윤금봉, 이종광, 최광학, 최이명', '퇴근 미체크: 김원동, 김춘동, 박호, 우미현, 조동래, 최진우, 허창학', '퇴근 미체크: 김우람, 김태곤, 박은혜, 이성훈, 이숙자, 이우성, 이태희, 한상호, 홍수희', '퇴근 미체크: 남민수, 오권석, 이운, 정민호', '퇴근 미체크: 이대균, 이선만, 이성균, 최동호'],
          hoverinfo: 'text+y+name',
          customdata: ['FNI', 'TMS(E)', 'BAT', 'C&A', 'P&S', 'TMS(M)']
        },
        {
          x: ['FNI', 'TMS(E)', 'BAT', 'C&A', 'P&S', 'TMS(M)'],
          y: [0, 10, 0, 4, 3, 0],
          name: '본사 인원',
          type: 'bar',
          text: [0, 10, 0, 4, 3, 0],
          textposition: 'inside',
          marker: {color: ['#2ca02c80', '#9467bd80', '#1f77b480', '#ff7f0e80', '#d6272880', '#8c564b80']},
          hovertext: ['본사 인원: 0, 공장 인원: 24', '본사 인원: 10, 공장 인원: 12', '본사 인원: 0, 공장 인원: 20', '본사 인원: 4, 공장 인원: 14', '본사 인원: 3, 공장 인원: 8', '본사 인원: 0, 공장 인원: 8'],
          hoverinfo: 'text+y+name',
          customdata: ['FNI', 'TMS(E)', 'BAT', 'C&A', 'P&S', 'TMS(M)']
        }
      ];
      var layout = {
        title: '🏭협력사별 출입 인원 수',
        barmode: 'stack',
        hovermode: 'closest',
        showlegend: true
      };
      var config = {
        displayModeBar: false,
        scrollZoom: false,
        staticPlot: false
      };
      Plotly.newPlot('bar-chart', data, layout, config);

      var lastOpened = null;
      document.getElementById('bar-chart').on('plotly_click', function(data) {
        var company = data.points[0].customdata;
        var target = document.getElementById(company + "-table");
        if (lastOpened === company) {
          target.style.display = "none";
          lastOpened = null;
        } else {
          document.querySelectorAll(".company-table").forEach(div => div.style.display = "none");
          target.style.display = "block";
          target.scrollIntoView({ behavior: "smooth" });
          lastOpened = company;
        }
      });
    </script>
    </body>
    </html>
    