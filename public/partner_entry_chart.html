
    <!DOCTYPE html>
    <html lang="ko">
    <head>
      <meta charset="UTF-8">
      <title>협력사 출입 대시보드</title>
      <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
      <style>
        .company-table { display: none; margin-top: 30px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
        th { background-color: #f0f0f0; }
        button { margin: 10px; padding: 8px 16px; background-color: #4CAF50; color: white; border: none; cursor: pointer; }
        button:hover { background-color: #45a049; }
      </style>
    </head>
    <body>
    <div id="bar-chart" style="width: 100%; height: 400px;"></div>
    
        <div id="BAT-table" class="company-table" style="display:none;">
            <h3>BAT 근무자 목록</h3>
            <button onclick="downloadCSV('BAT')">CSV 다운로드</button>
            <table border="1" style="width:500px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th><th>출근 시간</th><th>퇴근 시간</th></tr>
            <tr><td>간연웅</td><td>현장</td><td>2025. 6. 18 오전 7:54:03 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:54:03</td><td>미체크</td></tr><tr><td>김군</td><td>현장</td><td>2025. 6. 18 오전 7:38:14 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:38:14</td><td>미체크</td></tr><tr><td>김원동</td><td>현장</td><td>2025. 6. 18 오전 7:37:45 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:37:45</td><td>미체크</td></tr><tr><td>김춘동</td><td>현장</td><td>2025. 6. 18 오전 8:39:33 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:39:33</td><td>미체크</td></tr><tr><td>박종범</td><td>현장</td><td>2025. 6. 18 오전 7:33:07 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:33:07</td><td>미체크</td></tr><tr><td>박호</td><td>현장</td><td>2025. 6. 18 오전 7:37:18 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:37:18</td><td>미체크</td></tr><tr><td>배홍범</td><td>현장</td><td>2025. 6. 18 오전 8:22:42 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:22:42</td><td>미체크</td></tr><tr><td>우미정</td><td>현장</td><td>2025. 6. 18 오전 8:39:38 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:39:38</td><td>미체크</td></tr><tr><td>우미현</td><td>현장</td><td>2025. 6. 18 오전 8:34:54 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:34:54</td><td>미체크</td></tr><tr><td>윤청용</td><td>현장</td><td>2025. 6. 18 오전 7:47:39 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:47:39</td><td>미체크</td></tr><tr><td>전성환</td><td>현장</td><td>2025. 6. 18 오전 7:45:31 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:45:31</td><td>미체크</td></tr><tr><td>정인규</td><td>현장</td><td>2025. 6. 18 오전 7:30:14 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:30:14</td><td>미체크</td></tr><tr><td>조동래</td><td>현장</td><td>2025. 6. 18 오전 7:53:14 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:53:14</td><td>미체크</td></tr><tr><td>채은철</td><td>현장</td><td>2025. 6. 18 오전 7:39:35 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:39:35</td><td>미체크</td></tr><tr><td>최진우</td><td>현장</td><td>2025. 6. 18 오전 7:53:51 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:53:51</td><td>미체크</td></tr><tr><td>허용길</td><td>현장</td><td>2025. 6. 18 오전 7:47:51 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:47:51</td><td>미체크</td></tr><tr><td>허창학</td><td>현장</td><td>2025. 6. 18 오전 7:48:06 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:06</td><td>미체크</td></tr><tr><td>홍사현</td><td>현장</td><td>2025. 6. 18 오전 8:58:02 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:58:02</td><td>미체크</td></tr><tr><td>황호</td><td>현장</td><td>2025. 6. 18 오전 7:38:49 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:38:49</td><td>미체크</td></tr>
            </table>
        </div>
        
        <div id="C&A-table" class="company-table" style="display:none;">
            <h3>C&A 근무자 목록</h3>
            <button onclick="downloadCSV('C&A')">CSV 다운로드</button>
            <table border="1" style="width:500px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th><th>출근 시간</th><th>퇴근 시간</th></tr>
            <tr><td>김우람</td><td>본사</td><td>2025. 6. 18 오전 7:39:15 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:39:15</td><td>미체크</td></tr><tr><td>김인욱</td><td>현장</td><td>2025. 6. 18 오전 7:41:50 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:41:50</td><td>미체크</td></tr><tr><td>김태곤</td><td>본사</td><td>2025. 6. 18 오전 7:59:51 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:59:51</td><td>미체크</td></tr><tr><td>박새벽</td><td>현장</td><td>2025. 6. 18 오전 7:45:58 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:45:58</td><td>미체크</td></tr><tr><td>박수현</td><td>현장</td><td>2025. 6. 18 오전 8:26:10 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:26:10</td><td>미체크</td></tr><tr><td>박은혜</td><td>본사</td><td>2025. 6. 18 오전 7:50:13 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:50:13</td><td>미체크</td></tr><tr><td>박준성</td><td>본사CHI_2</td><td>0시간 0분</td><td>2025. 6. 18 오전 8:00:44</td><td>2팀</td></tr><tr><td>백상걸</td><td>현장</td><td>2025. 6. 18 오전 7:44:14 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:44:14</td><td>미체크</td></tr><tr><td>성길용</td><td>현장</td><td>2025. 6. 18 오전 7:59:13 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:59:13</td><td>미체크</td></tr><tr><td>윤문빈</td><td>현장</td><td>2025. 6. 18 오전 7:48:20 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:20</td><td>미체크</td></tr><tr><td>이성훈</td><td>본사</td><td>2025. 6. 18 오전 7:50:47 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:50:47</td><td>미체크</td></tr><tr><td>이숙자</td><td>본사</td><td>2025. 6. 18 오전 7:50:01 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:50:01</td><td>미체크</td></tr><tr><td>이영찬</td><td>본사CHI_2</td><td>0시간 0분</td><td>2025. 6. 18 오전 7:59:04</td><td>2팀</td></tr><tr><td>이태희</td><td>본사CHI_1</td><td>0시간 0분</td><td>2025. 6. 18 오전 7:56:55</td><td>1팀</td></tr><tr><td>임영대</td><td>본사CHI_2</td><td>0시간 0분</td><td>2025. 6. 18 오전 10:23:59</td><td>2팀</td></tr><tr><td>임영목</td><td>본사CHI_2</td><td>0시간 0분</td><td>2025. 6. 18 오전 7:50:11</td><td>2팀</td></tr><tr><td>정용진</td><td>현장</td><td>2025. 6. 18 오전 7:48:11 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:11</td><td>미체크</td></tr><tr><td>정지성</td><td>현장</td><td>2025. 6. 18 오전 7:54:13 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:54:13</td><td>미체크</td></tr><tr><td>조성호</td><td>현장</td><td>2025. 6. 18 오전 7:51:25 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:51:25</td><td>미체크</td></tr><tr><td>한상준</td><td>본사CHI_2</td><td>0시간 0분</td><td>2025. 6. 18 오전 8:01:44</td><td>2팀</td></tr><tr><td>한상호</td><td>본사CHI_1</td><td>0시간 0분</td><td>2025. 6. 18 오전 7:58:13</td><td>1팀</td></tr><tr><td>홍수희</td><td>본사</td><td>2025. 6. 18 오전 8:02:45 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:02:45</td><td>미체크</td></tr>
            </table>
        </div>
        
        <div id="FNI-table" class="company-table" style="display:none;">
            <h3>FNI 근무자 목록</h3>
            <button onclick="downloadCSV('FNI')">CSV 다운로드</button>
            <table border="1" style="width:500px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th><th>출근 시간</th><th>퇴근 시간</th></tr>
            <tr><td>권민수</td><td>현장</td><td>2025. 6. 18 오전 7:38:26 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:38:26</td><td>미체크</td></tr><tr><td>김용수</td><td>현장</td><td>2025. 6. 18 오전 7:51:17 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:51:17</td><td>미체크</td></tr><tr><td>박주성</td><td>현장</td><td>2025. 6. 18 오전 7:13:01 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:13:01</td><td>미체크</td></tr><tr><td>박천일</td><td>현장</td><td>2025. 6. 18 오전 7:56:25 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:56:25</td><td>미체크</td></tr><tr><td>박춘광</td><td>현장</td><td>2025. 6. 18 오전 7:48:36 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:36</td><td>미체크</td></tr><tr><td>서정원</td><td>현장</td><td>2025. 6. 18 오전 7:29:18 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:29:18</td><td>미체크</td></tr><tr><td>손국권</td><td>현장</td><td>2025. 6. 18 오전 7:36:53 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:36:53</td><td>미체크</td></tr><tr><td>안유성</td><td>현장</td><td>2025. 6. 18 오전 7:48:19 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:19</td><td>미체크</td></tr><tr><td>오동혁</td><td>현장</td><td>2025. 6. 18 오전 8:01:17 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:01:17</td><td>미체크</td></tr><tr><td>유승민</td><td>현장</td><td>2025. 6. 18 오전 7:39:07 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:39:07</td><td>미체크</td></tr><tr><td>윤광성</td><td>현장</td><td>2025. 6. 18 오전 7:30:44 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:30:44</td><td>미체크</td></tr><tr><td>윤춘국</td><td>현장</td><td>2025. 6. 18 오전 7:56:12 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:56:12</td><td>미체크</td></tr><tr><td>이승진</td><td>현장</td><td>2025. 6. 18 오전 8:03:24 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:03:24</td><td>미체크</td></tr><tr><td>이영자</td><td>현장</td><td>2025. 6. 18 오전 7:51:02 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:51:02</td><td>미체크</td></tr><tr><td>이은학</td><td>현장</td><td>2025. 6. 18 오전 7:48:52 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:52</td><td>미체크</td></tr><tr><td>허문용</td><td>현장</td><td>2025. 6. 18 오전 8:01:56 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:01:56</td><td>미체크</td></tr><tr><td>홍용천</td><td>현장</td><td>2025. 6. 18 오전 7:56:02 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:56:02</td><td>미체크</td></tr><tr><td>황진충</td><td>현장</td><td>2025. 6. 18 오전 7:29:37 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:29:37</td><td>미체크</td></tr>
            </table>
        </div>
        
        <div id="P&S-table" class="company-table" style="display:none;">
            <h3>P&S 근무자 목록</h3>
            <button onclick="downloadCSV('P&S')">CSV 다운로드</button>
            <table border="1" style="width:500px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th><th>출근 시간</th><th>퇴근 시간</th></tr>
            <tr><td>강기준</td><td>현장</td><td>2025. 6. 18 오전 8:01:54 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:01:54</td><td>미체크</td></tr><tr><td>김홍매</td><td>본사</td><td>2025. 6. 18 오전 8:04:40 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:04:40</td><td>미체크</td></tr><tr><td>박광진</td><td>현장</td><td>2025. 6. 18 오전 8:14:44 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:14:44</td><td>미체크</td></tr><tr><td>오권석</td><td>현장</td><td>2025. 6. 18 오전 8:03:01 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:03:01</td><td>미체크</td></tr><tr><td>오해동</td><td>현장</td><td>2025. 6. 18 오전 8:14:09 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:14:09</td><td>미체크</td></tr><tr><td>이옥매</td><td>본사</td><td>2025. 6. 18 오전 8:13:59 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:13:59</td><td>미체크</td></tr><tr><td>이운</td><td>현장</td><td>2025. 6. 18 오전 8:04:35 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:04:35</td><td>미체크</td></tr><tr><td>정민호</td><td>현장</td><td>2025. 6. 18 오전 8:00:52 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:00:52</td><td>미체크</td></tr><tr><td>주용범</td><td>현장</td><td>2025. 6. 18 오전 8:15:52 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:15:52</td><td>미체크</td></tr><tr><td>최윤철</td><td>현장</td><td>2025. 6. 18 오전 8:19:10 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:19:10</td><td>미체크</td></tr>
            </table>
        </div>
        
        <div id="TMS(E)-table" class="company-table" style="display:none;">
            <h3>TMS(E) 근무자 목록</h3>
            <button onclick="downloadCSV('TMS(E)')">CSV 다운로드</button>
            <table border="1" style="width:500px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th><th>출근 시간</th><th>퇴근 시간</th></tr>
            <tr><td>공종필</td><td>현장</td><td>2025. 6. 18 오전 7:35:27 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:35:27</td><td>미체크</td></tr><tr><td>김삼구</td><td>본사</td><td>2025. 6. 18 오전 7:56:51 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:56:51</td><td>미체크</td></tr><tr><td>김성규</td><td>현장CHI</td><td>2025. 6. 18 오전 8:37:56 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:37:56</td><td>미체크</td></tr><tr><td>김재호</td><td>현장</td><td>2025. 6. 18 오전 7:30:09 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:30:09</td><td>미체크</td></tr><tr><td>김주용</td><td>현장</td><td>2025. 6. 18 오전 7:33:34 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:33:34</td><td>미체크</td></tr><tr><td>김준</td><td>현장</td><td>2025. 6. 18 오전 8:46:58 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:46:58</td><td>미체크</td></tr><tr><td>김창조</td><td>현장</td><td>2025. 6. 18 오전 7:04:30 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:04:30</td><td>미체크</td></tr><tr><td>김형석</td><td>본사</td><td>2025. 6. 18 오전 7:54:29 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:54:29</td><td>미체크</td></tr><tr><td>노윤제</td><td>현장</td><td>2025. 6. 18 오전 10:01:44 (퇴근 미체크)</td><td>2025. 6. 18 오전 10:01:44</td><td>미체크</td></tr><tr><td>오세훈</td><td>본사</td><td>2025. 6. 18 오전 7:53:56 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:53:56</td><td>미체크</td></tr><tr><td>오정석</td><td>본사</td><td>2025. 6. 18 오전 7:02:15 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:02:15</td><td>미체크</td></tr><tr><td>우강</td><td>현장</td><td>2025. 6. 18 오전 8:25:53 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:25:53</td><td>미체크</td></tr><tr><td>유민상</td><td>본사</td><td>2025. 6. 18 오전 8:23:27 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:23:27</td><td>미체크</td></tr><tr><td>윤금봉</td><td>현장</td><td>2025. 6. 18 오전 8:35:40 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:35:40</td><td>미체크</td></tr><tr><td>윤성구</td><td>본사</td><td>2025. 6. 18 오전 7:51:58 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:51:58</td><td>미체크</td></tr><tr><td>이동구</td><td>본사</td><td>2025. 6. 18 오전 7:58:58 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:58:58</td><td>미체크</td></tr><tr><td>이종광</td><td>현장</td><td>2025. 6. 18 오전 7:49:49 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:49:49</td><td>미체크</td></tr><tr><td>이효주</td><td>본사</td><td>2025. 6. 18 오전 7:56:23 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:56:23</td><td>미체크</td></tr><tr><td>전준룡</td><td>본사</td><td>2025. 6. 18 오전 7:26:38 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:26:38</td><td>미체크</td></tr><tr><td>최광학</td><td>현장</td><td>2025. 6. 18 오전 7:07:01 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:07:01</td><td>미체크</td></tr><tr><td>최선희</td><td>본사</td><td>2025. 6. 18 오전 7:51:19 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:51:19</td><td>미체크</td></tr><tr><td>최이명</td><td>현장CHI</td><td>2025. 6. 18 오전 7:47:14 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:47:14</td><td>미체크</td></tr><tr><td>황금산</td><td>현장CHI</td><td>2025. 6. 18 오전 7:40:43 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:40:43</td><td>미체크</td></tr>
            </table>
        </div>
        
        <div id="TMS(M)-table" class="company-table" style="display:none;">
            <h3>TMS(M) 근무자 목록</h3>
            <button onclick="downloadCSV('TMS(M)')">CSV 다운로드</button>
            <table border="1" style="width:500px;"><tr><th>이름</th><th>담당 업무</th><th>근무시간</th><th>출근 시간</th><th>퇴근 시간</th></tr>
            <tr><td>김경민</td><td>현장</td><td>2025. 6. 18 오전 7:47:10 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:47:10</td><td>미체크</td></tr><tr><td>김선교</td><td>현장</td><td>2025. 6. 18 오전 8:02:38 (퇴근 미체크)</td><td>2025. 6. 18 오전 8:02:38</td><td>미체크</td></tr><tr><td>이대균</td><td>현장</td><td>2025. 6. 18 오전 7:57:31 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:57:31</td><td>미체크</td></tr><tr><td>이동민</td><td>현장</td><td>2025. 6. 18 오전 7:18:43 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:18:43</td><td>미체크</td></tr><tr><td>이선만</td><td>현장</td><td>2025. 6. 18 오전 7:49:15 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:49:15</td><td>미체크</td></tr><tr><td>이성균</td><td>현장</td><td>2025. 6. 18 오전 7:58:11 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:58:11</td><td>미체크</td></tr><tr><td>이용</td><td>현장</td><td>2025. 6. 18 오전 7:47:51 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:47:51</td><td>미체크</td></tr><tr><td>지화</td><td>현장</td><td>2025. 6. 18 오전 7:48:30 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:48:30</td><td>미체크</td></tr><tr><td>최동호</td><td>현장</td><td>2025. 6. 18 오전 7:01:12 (퇴근 미체크)</td><td>2025. 6. 18 오전 7:01:12</td><td>미체크</td></tr>
            </table>
        </div>
        
    <script>
      var companies = ["TMS(E)", "C&A", "BAT", "FNI", "P&S", "TMS(M)"];
      var siteCounts = [10, 9, 19, 18, 8, 9];
      var hqCounts = [10, 6, 0, 0, 2, 0];
      var hqChi1Counts = [0, 2, 0, 0, 0, 0];
      var hqChi2Counts = [0, 5, 0, 0, 0, 0];
      var siteChiCounts = [3, 0, 0, 0, 0, 0];
      var barColors = ["#9467bd", "#ff7f0e", "#1f77b4", "#2ca02c", "#d62728", "#8c564b"];
      var hqBarColors = ["#9467bd80", "#ff7f0e80", "#1f77b480", "#2ca02c80", "#d6272880", "#8c564b80"];
      var hqChi1BarColors = ["#9467bd60", "#ff7f0e60", "#1f77b460", "#2ca02c60", "#d6272860", "#8c564b60"];
      var hqChi2BarColors = ["#9467bd50", "#ff7f0e50", "#1f77b450", "#2ca02c50", "#d6272850", "#8c564b50"];
      var siteChiBarColors = ["#9467bd40", "#ff7f0e40", "#1f77b440", "#2ca02c40", "#d6272840", "#8c564b40"];
      var tooltipMiss = ["\ud1f4\uadfc \ubbf8\uccb4\ud06c: \uacf5\uc885\ud544, \uae40\uc0bc\uad6c, \uae40\uc131\uaddc, \uae40\uc7ac\ud638, \uae40\uc8fc\uc6a9, \uae40\uc900, \uae40\ucc3d\uc870, \uae40\ud615\uc11d, \ub178\uc724\uc81c, \uc624\uc138\ud6c8, \uc624\uc815\uc11d, \uc6b0\uac15, \uc720\ubbfc\uc0c1, \uc724\uae08\ubd09, \uc724\uc131\uad6c, \uc774\ub3d9\uad6c, \uc774\uc885\uad11, \uc774\ud6a8\uc8fc, \uc804\uc900\ub8e1, \ucd5c\uad11\ud559, \ucd5c\uc120\ud76c, \ucd5c\uc774\uba85, \ud669\uae08\uc0b0", "\ud1f4\uadfc \ubbf8\uccb4\ud06c: \uae40\uc6b0\ub78c, \uae40\uc778\uc6b1, \uae40\ud0dc\uace4, \ubc15\uc0c8\ubcbd, \ubc15\uc218\ud604, \ubc15\uc740\ud61c, \ubc31\uc0c1\uac78, \uc131\uae38\uc6a9, \uc724\ubb38\ube48, \uc774\uc131\ud6c8, \uc774\uc219\uc790, \uc815\uc6a9\uc9c4, \uc815\uc9c0\uc131, \uc870\uc131\ud638, \ud64d\uc218\ud76c", "\ud1f4\uadfc \ubbf8\uccb4\ud06c: \uac04\uc5f0\uc6c5, \uae40\uad70, \uae40\uc6d0\ub3d9, \uae40\ucd98\ub3d9, \ubc15\uc885\ubc94, \ubc15\ud638, \ubc30\ud64d\ubc94, \uc6b0\ubbf8\uc815, \uc6b0\ubbf8\ud604, \uc724\uccad\uc6a9, \uc804\uc131\ud658, \uc815\uc778\uaddc, \uc870\ub3d9\ub798, \ucc44\uc740\ucca0, \ucd5c\uc9c4\uc6b0, \ud5c8\uc6a9\uae38, \ud5c8\ucc3d\ud559, \ud64d\uc0ac\ud604, \ud669\ud638", "\ud1f4\uadfc \ubbf8\uccb4\ud06c: \uad8c\ubbfc\uc218, \uae40\uc6a9\uc218, \ubc15\uc8fc\uc131, \ubc15\ucc9c\uc77c, \ubc15\ucd98\uad11, \uc11c\uc815\uc6d0, \uc190\uad6d\uad8c, \uc548\uc720\uc131, \uc624\ub3d9\ud601, \uc720\uc2b9\ubbfc, \uc724\uad11\uc131, \uc724\ucd98\uad6d, \uc774\uc2b9\uc9c4, \uc774\uc601\uc790, \uc774\uc740\ud559, \ud5c8\ubb38\uc6a9, \ud64d\uc6a9\ucc9c, \ud669\uc9c4\ucda9", "\ud1f4\uadfc \ubbf8\uccb4\ud06c: \uac15\uae30\uc900, \uae40\ud64d\ub9e4, \ubc15\uad11\uc9c4, \uc624\uad8c\uc11d, \uc624\ud574\ub3d9, \uc774\uc625\ub9e4, \uc774\uc6b4, \uc815\ubbfc\ud638, \uc8fc\uc6a9\ubc94, \ucd5c\uc724\ucca0", "\ud1f4\uadfc \ubbf8\uccb4\ud06c: \uae40\uacbd\ubbfc, \uae40\uc120\uad50, \uc774\ub300\uade0, \uc774\ub3d9\ubbfc, \uc774\uc120\ub9cc, \uc774\uc131\uade0, \uc774\uc6a9, \uc9c0\ud654, \ucd5c\ub3d9\ud638"];
      var tooltipHq = ["\ubcf8\uc0ac \uc778\uc6d0: 10, \ubcf8\uc0acCHI_1 \uc778\uc6d0: 0, \ubcf8\uc0acCHI_2 \uc778\uc6d0: 0, \ud604\uc7a5CHI \uc778\uc6d0: 3, \ud604\uc7a5 \uc778\uc6d0: 10", "\ubcf8\uc0ac \uc778\uc6d0: 6, \ubcf8\uc0acCHI_1 \uc778\uc6d0: 2, \ubcf8\uc0acCHI_2 \uc778\uc6d0: 5, \ud604\uc7a5CHI \uc778\uc6d0: 0, \ud604\uc7a5 \uc778\uc6d0: 9", "\ubcf8\uc0ac \uc778\uc6d0: 0, \ubcf8\uc0acCHI_1 \uc778\uc6d0: 0, \ubcf8\uc0acCHI_2 \uc778\uc6d0: 0, \ud604\uc7a5CHI \uc778\uc6d0: 0, \ud604\uc7a5 \uc778\uc6d0: 19", "\ubcf8\uc0ac \uc778\uc6d0: 0, \ubcf8\uc0acCHI_1 \uc778\uc6d0: 0, \ubcf8\uc0acCHI_2 \uc778\uc6d0: 0, \ud604\uc7a5CHI \uc778\uc6d0: 0, \ud604\uc7a5 \uc778\uc6d0: 18", "\ubcf8\uc0ac \uc778\uc6d0: 2, \ubcf8\uc0acCHI_1 \uc778\uc6d0: 0, \ubcf8\uc0acCHI_2 \uc778\uc6d0: 0, \ud604\uc7a5CHI \uc778\uc6d0: 0, \ud604\uc7a5 \uc778\uc6d0: 8", "\ubcf8\uc0ac \uc778\uc6d0: 0, \ubcf8\uc0acCHI_1 \uc778\uc6d0: 0, \ubcf8\uc0acCHI_2 \uc778\uc6d0: 0, \ud604\uc7a5CHI \uc778\uc6d0: 0, \ud604\uc7a5 \uc778\uc6d0: 9"];
      var weekNumber = 25

      var data = [
        {
          x: companies,
          y: siteCounts,
          name: '현장 인원',
          type: 'bar',
          text: siteCounts,
          textposition: 'inside',
          marker: {color: barColors},
          hovertext: tooltipMiss,
          hoverinfo: 'text+y+name',
          customdata: companies
        },
        {
          x: companies,
          y: hqCounts,
          name: '본사 인원',
          type: 'bar',
          text: hqCounts,
          textposition: 'inside',
          marker: {color: hqBarColors},
          hovertext: tooltipHq,
          hoverinfo: 'text+y+name',
          customdata: companies
        },
        {
          x: companies,
          y: hqChi1Counts,
          name: '본사CHI_1 인원',
          type: 'bar',
          text: hqChi1Counts,
          textposition: 'inside',
          marker: {color: hqChi1BarColors},
          hovertext: tooltipHq,
          hoverinfo: 'text+y+name',
          customdata: companies
        },
        {
          x: companies,
          y: hqChi2Counts,
          name: '본사CHI_2 인원',
          type: 'bar',
          text: hqChi2Counts,
          textposition: 'inside',
          marker: {color: hqChi2BarColors},
          hovertext: tooltipHq,
          hoverinfo: 'text+y+name',
          customdata: companies
        },
        {
          x: companies,
          y: siteChiCounts,
          name: '현장CHI 인원',
          type: 'bar',
          text: siteChiCounts,
          textposition: 'inside',
          marker: {color: siteChiBarColors},
          hovertext: tooltipHq,
          hoverinfo: 'text+y+name',
          customdata: companies
        }
      ];
      var layout = {
        title: '🏭협력사별 출입 인원 수',
        barmode: 'stack',
        hovermode: 'closest',
        showlegend: true
      };
      var config = {
        displayModeBar: false,
        scrollZoom: false,
        staticPlot: false
      };
      Plotly.newPlot('bar-chart', data, layout, config);

      var lastOpened = null;
      document.getElementById('bar-chart').on('plotly_click', function(data) {
        var company = data.points[0].customdata;
        var target = document.getElementById(company + "-table");
        if (lastOpened === company) {
          target.style.display = "none";
          lastOpened = null;
        } else {
          document.querySelectorAll(".company-table").forEach(div => div.style.display = "none");
          target.style.display = "block";
          target.scrollIntoView({ behavior: "smooth" });
          lastOpened = company;
        }
      });

      function downloadCSV(company) {
        try {
          var compTable = document.getElementById(company + "-table");
          var rows = compTable.querySelectorAll("table tr");
          var csvContent = "﻿";
          csvContent += "이름,담당 업무,근무시간,출근 시간,퇴근 시간\n"; // 헤더에 출퇴근 시간 추가
          for (var i = 1; i < rows.length; i++) {
            var cells = rows[i].querySelectorAll("td");
            var rowData = [
              '"' + cells[0].innerText.replace(/"/g, '""') + '"',
              '"' + cells[1].innerText.replace(/"/g, '""') + '"',
              '"' + cells[2].innerText.replace(/"/g, '""') + '"',
              '"' + cells[3].innerText.replace(/"/g, '""') + '"', // 출근 시간
              '"' + cells[4].innerText.replace(/"/g, '""') + '"'   // 퇴근 시간
            ];
            csvContent += rowData.join(",") + "\n";
          }

          var weekData = [];
          fetch(`/weekly_data/${company}_week_${weekNumber}.json`)
            .then(response => response.json())
            .then(data => {
              weekData = data;
              csvContent += "\n주간 데이터:\n";
              csvContent += "이름,담당 업무,출근 시간,퇴근 시간,근무시간,퇴근미체크\n";
              weekData.forEach(item => {
                var rowData = [
                  '"' + (item["이름"] || "").replace(/"/g, '""') + '"',
                  '"' + (item["담당 업무"] || "").replace(/"/g, '""') + '"',
                  '"' + (item["출근 시간"] || "").replace(/"/g, '""') + '"',
                  '"' + (item["퇴근 시간"] || "").replace(/"/g, '""') + '"',
                  '"' + (item["근무시간(H:M)"] || "").replace(/"/g, '""') + '"',
                  '"' + (item["퇴근미체크"] ? "예" : "아니오") + '"'
                ];
                csvContent += rowData.join(",") + "\n";
              });

              var today = new Date();
              var dateStr = today.getFullYear() + String(today.getMonth() + 1).padStart(2, '0') + String(today.getDate()).padStart(2, '0');
              var fileName = `${company}_entry_list_${dateStr}.csv`;
              var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
              var url = window.URL.createObjectURL(blob);
              var link = document.createElement('a');
              link.setAttribute('href', url);
              link.setAttribute('download', fileName);
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              window.URL.revokeObjectURL(url);
            })
            .catch(error => {
              console.error("Error fetching weekly data:", error);
              alert("주간 데이터를 가져오지 못했습니다. 당일 데이터만 다운로드됩니다.");
              var today = new Date();
              var dateStr = today.getFullYear() + String(today.getMonth() + 1).padStart(2, '0') + String(today.getDate()).padStart(2, '0');
              var fileName = `${company}_entry_list_${dateStr}.csv`;
              var blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
              var url = window.URL.createObjectURL(blob);
              var link = document.createElement('a');
              link.setAttribute('href', url);
              link.setAttribute('download', fileName);
              document.body.appendChild(link);
              link.click();
              document.body.removeChild(link);
              window.URL.revokeObjectURL(url);
            });
        } catch (error) {
          console.error("CSV download error:", error);
          alert("CSV 다운로드 중 오류가 발생했습니다.");
        }
      }
    </script>
    </body>
    </html>
    