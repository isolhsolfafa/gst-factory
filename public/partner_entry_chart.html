
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🏢 협력사 출입 현황 (일자별 관리)</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <style>
        body { font-family: 'Malgun Gothic', 'Segoe UI', sans-serif; margin: 0; padding: 20px; background-color: #f5f5f5; }
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 30px; border-radius: 10px 10px 0 0; text-align: center; }
        .stats { display: flex; justify-content: space-around; margin: 20px 0; flex-wrap: wrap; }
        .stat-item { text-align: center; margin: 10px; }
        .chart-container { margin: 20px; padding: 20px; }
        .company-section { margin: 20px; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; }
        .company-header { background: #3498db; color: white; padding: 15px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; }
        .company-header:hover { background: #2980b9; }
        .company-content { display: none; padding: 20px; }
        .company-content.active { display: block; }
        .date-buttons { margin: 15px 0; }
        .date-btn { background: #27ae60; color: white; border: none; padding: 8px 16px; margin: 3px; border-radius: 4px; cursor: pointer; font-size: 12px; }
        .date-btn:hover { background: #229954; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th, td { padding: 10px; text-align: left; border-bottom: 1px solid #ddd; font-size: 14px; }
        th { background-color: #f8f9fa; font-weight: bold; }
        .overtime { color: #e74c3c; font-weight: bold; }
        .normal { color: #27ae60; }
        .missing { color: #f39c12; font-weight: bold; }
        .toggle-icon { font-size: 18px; transition: transform 0.3s; }
        .toggle-icon.active { transform: rotate(180deg); }
        .summary-badge { background: rgba(255,255,255,0.2); padding: 5px 10px; border-radius: 15px; font-size: 12px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🏢 협력사 출입 현황 (일자별 관리)</h1>
            <div class="stats">
                <div class="stat-item">📊 총 회사: 7개</div>
                <div class="stat-item">👥 총 인원: 122명</div>
                <div class="stat-item">🕐 생성일시: 2026년 01월 30일 20시 41분</div>
                <div class="stat-item">📋 관리방식: 일자별 독립 관리</div>
            </div>
        </div>
        
        <div class="chart-container">
            <div id="bar-chart" style="width: 100%; height: 400px;"></div>
        </div>
        
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_0')">
                <div>
                    <h3>🏗️ BAT (총 25명: 본사 0명, 현장 25명)</h3>
                    <small style="opacity: 0.8;">상세: 현장 25명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 6명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_0">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('BAT', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>간연웅</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:52:26</td>
                    <td>2026. 1. 30 16:47:55</td>
                    <td class="normal">7시간 8분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김군</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:35:48</td>
                    <td>2026. 1. 30 16:59:16</td>
                    <td class="normal">7시간 19분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김범곤</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:48:13</td>
                    <td>2026. 1. 30 16:48:30</td>
                    <td class="normal">6시간 20분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김원동</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:42:31</td>
                    <td>2026. 1. 30 16:57:51</td>
                    <td class="normal">7시간 18분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김춘동</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:30:29</td>
                    <td>2026. 1. 30 17:09:59</td>
                    <td class="normal">7시간 0분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박호</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:46:17</td>
                    <td>2026. 1. 30 17:01:03</td>
                    <td class="normal">7시간 21분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>반경태</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:42:09</td>
                    <td>2026. 1. 30 16:51:18</td>
                    <td class="normal">7시간 11분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>배홍범</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:04:40</td>
                    <td>2026. 1. 30 16:43:46</td>
                    <td class="normal">6시간 59분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>심영수</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:42:51</td>
                    <td>2026. 1. 30 16:47:59</td>
                    <td class="normal">7시간 8분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>안학철</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:59:50</td>
                    <td>2026. 1. 30 16:43:41</td>
                    <td class="normal">7시간 4분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>오승열</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:45:38</td>
                    <td>2026. 1. 30 16:48:04</td>
                    <td class="normal">7시간 8분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>우미정</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:42:46</td>
                    <td>2026. 1. 30 16:48:21</td>
                    <td class="normal">6시간 26분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>우미현</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:31:15</td>
                    <td>2026. 1. 30 16:55:12</td>
                    <td class="normal">6시간 44분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이영남</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:04:29</td>
                    <td>2026. 1. 30 16:47:46</td>
                    <td class="normal">7시간 3분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>전미래</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:52:56</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>전성환</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:56:51</td>
                    <td>2026. 1. 30 16:48:06</td>
                    <td class="normal">7시간 8분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>정대한</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:21:55</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>정인규</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:30:16</td>
                    <td>2026. 1. 30 17:00:15</td>
                    <td class="normal">7시간 20분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>조동래</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:54:13</td>
                    <td>2026. 1. 30 16:50:32</td>
                    <td class="normal">7시간 11분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>채림</td>
                    <td>현장</td>
                    <td>2026. 1. 30 6:24:47</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>채은철</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:44:51</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>최성범</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:56:59</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>최진우</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:57:14</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>허용길</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:48:26</td>
                    <td>2026. 1. 30 16:42:06</td>
                    <td class="normal">7시간 2분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>홍사현</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:00:07</td>
                    <td>2026. 1. 30 16:48:54</td>
                    <td class="normal">7시간 9분</td>
                    <td>아니오</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_1')">
                <div>
                    <h3>⚡ C&A (총 24명: 본사 11명, 현장 13명)</h3>
                    <small style="opacity: 0.8;">상세: 본사 9명, 본사CHI_2 2명, 현장 13명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 6명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_1">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('C&A', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>기현채</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:44:48</td>
                    <td>2026. 1. 30 17:00:53</td>
                    <td class="normal">7시간 21분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김시우</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:56:19</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>김우람</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:49:27</td>
                    <td>2026. 1. 30 20:00:23</td>
                    <td class="normal">9시간 20분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김진선</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:49:02</td>
                    <td>2026. 1. 30 17:00:05</td>
                    <td class="normal">7시간 20분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김진영</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:49:21</td>
                    <td>2026. 1. 30 17:00:34</td>
                    <td class="normal">7시간 21분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김하늘</td>
                    <td>본사</td>
                    <td>2026. 1. 30 16:33:40</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>라경숙</td>
                    <td>본사CHI_2</td>
                    <td>2026. 1. 30 7:58:58</td>
                    <td>2026. 1. 30 17:15:27</td>
                    <td class="normal">7시간 35분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>문혁주</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:47:25</td>
                    <td>2026. 1. 30 17:01:04</td>
                    <td class="normal">7시간 21분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박금명</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:51:15</td>
                    <td>2026. 1. 30 17:03:54</td>
                    <td class="normal">7시간 24분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박새벽</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:02</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>박은혜</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:55:15</td>
                    <td>2026. 1. 30 17:00:17</td>
                    <td class="normal">7시간 20분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박재성</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:56:09</td>
                    <td>2026. 1. 30 17:03:54</td>
                    <td class="normal">7시간 24분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>백상걸</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:59:46</td>
                    <td>2026. 1. 30 16:40:41</td>
                    <td class="normal">7시간 1분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>성길용</td>
                    <td>현장</td>
                    <td>2026. 1. 30 16:57:50</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>송형우</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:38:14</td>
                    <td>2026. 1. 30 17:01:47</td>
                    <td class="normal">7시간 22분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>안란</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:05:40</td>
                    <td>2026. 1. 30 17:01:38</td>
                    <td class="normal">7시간 16분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>안설화</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:28</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>윤문빈</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:52</td>
                    <td>2026. 1. 30 16:30:10</td>
                    <td class="normal">6시간 50분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이성훈</td>
                    <td>본사</td>
                    <td>2026. 1. 30 16:57:48</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이우성</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:59:38</td>
                    <td>2026. 1. 30 17:00:25</td>
                    <td class="normal">7시간 20분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>임영목</td>
                    <td>본사CHI_2</td>
                    <td>2026. 1. 30 8:02:53</td>
                    <td>2026. 1. 30 17:27:06</td>
                    <td class="normal">7시간 44분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>정용진</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:45:28</td>
                    <td>2026. 1. 30 16:33:44</td>
                    <td class="normal">6시간 54분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>정홍원</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:20</td>
                    <td>2026. 1. 30 17:17:37</td>
                    <td class="normal">7시간 38분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>홍수희</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:56:21</td>
                    <td>2026. 1. 30 16:57:24</td>
                    <td class="normal">7시간 17분</td>
                    <td>아니오</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_2')">
                <div>
                    <h3>🏗️ FNI (총 23명: 본사 0명, 현장 23명)</h3>
                    <small style="opacity: 0.8;">상세: 현장 23명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 7명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_2">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('FNI', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>권민수</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:44:38</td>
                    <td>2026. 1. 30 16:51:15</td>
                    <td class="normal">7시간 11분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김용수</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:53:31</td>
                    <td>2026. 1. 30 16:57:27</td>
                    <td class="normal">7시간 17분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김창국</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:40:33</td>
                    <td>2026. 1. 30 17:03:37</td>
                    <td class="normal">7시간 24분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박연파</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:43:48</td>
                    <td>2026. 1. 30 16:53:52</td>
                    <td class="normal">7시간 14분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박주성</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:43:28</td>
                    <td>2026. 1. 30 16:52:07</td>
                    <td class="normal">7시간 12분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박천일</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:38:43</td>
                    <td>2026. 1. 30 16:51:42</td>
                    <td class="normal">7시간 12분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>변기선</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:18</td>
                    <td>2026. 1. 30 17:13:48</td>
                    <td class="normal">7시간 34분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>서명환</td>
                    <td>현장</td>
                    <td>2026. 1. 30 6:59:42</td>
                    <td>2026. 1. 30 17:06:40</td>
                    <td class="normal">7시간 27분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>서정원</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:53:37</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>손국권</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:51:34</td>
                    <td>2026. 1. 30 16:51:48</td>
                    <td class="normal">7시간 12분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>안유성</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:34:06</td>
                    <td>2026. 1. 30 16:58:56</td>
                    <td class="normal">7시간 19분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>유승민</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:21:41</td>
                    <td>2026. 1. 30 16:52:42</td>
                    <td class="normal">7시간 13분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>윤광성</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:27</td>
                    <td>2026. 1. 30 16:50:56</td>
                    <td class="normal">7시간 11분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>윤석우</td>
                    <td>현장</td>
                    <td>2026. 1. 30 17:00:26</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>윤춘국</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:14:26</td>
                    <td>2026. 1. 30 16:51:21</td>
                    <td class="normal">6시간 57분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이민철</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:39:33</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이영식</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:53:56</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이영자</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:55:20</td>
                    <td>2026. 1. 30 16:53:24</td>
                    <td class="normal">7시간 13분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이은학</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:49:55</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이일호</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:54:46</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이태훈</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:57:21</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>전우민</td>
                    <td>현장</td>
                    <td>2026. 1. 30 6:39:27</td>
                    <td>2026. 1. 30 17:00:34</td>
                    <td class="normal">7시간 21분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>황진충</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:21:08</td>
                    <td>2026. 1. 30 16:54:38</td>
                    <td class="normal">7시간 15분</td>
                    <td>아니오</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_3')">
                <div>
                    <h3>⚡ TMS(E) (총 23명: 본사 11명, 현장 12명)</h3>
                    <small style="opacity: 0.8;">상세: 본사 11명, 현장 10명, 현장CHI 2명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 3명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_3">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(E)', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>공종필</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:46:02</td>
                    <td>2026. 1. 30 16:29:54</td>
                    <td class="normal">6시간 50분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김단국</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:43:54</td>
                    <td>2026. 1. 30 16:32:04</td>
                    <td class="normal">6시간 8분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김삼구</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:55:50</td>
                    <td>2026. 1. 30 16:56:17</td>
                    <td class="normal">7시간 16분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김상명</td>
                    <td>현장</td>
                    <td>2026. 1. 30 16:32:13</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>김성규</td>
                    <td>현장CHI</td>
                    <td>2026. 1. 30 8:38:46</td>
                    <td>2026. 1. 30 16:33:50</td>
                    <td class="normal">6시간 15분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김재호</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:01:04</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>김주용</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:30:43</td>
                    <td>2026. 1. 30 16:32:31</td>
                    <td class="normal">6시간 22분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김준</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:43:49</td>
                    <td>2026. 1. 30 16:30:29</td>
                    <td class="normal">6시간 7분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김창조</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:00:31</td>
                    <td>2026. 1. 30 16:28:23</td>
                    <td class="normal">6시간 48분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김형석</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:49:49</td>
                    <td>2026. 1. 30 17:13:40</td>
                    <td class="normal">7시간 34분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>오세훈</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:46:22</td>
                    <td>2026. 1. 30 17:02:35</td>
                    <td class="normal">7시간 23분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>오정석</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:48:30</td>
                    <td>2026. 1. 30 16:59:05</td>
                    <td class="normal">7시간 19분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>우강</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:44:01</td>
                    <td>2026. 1. 30 16:32:37</td>
                    <td class="normal">6시간 9분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>유민상</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:40:13</td>
                    <td>2026. 1. 30 17:14:13</td>
                    <td class="normal">7시간 34분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>윤금봉</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:43:47</td>
                    <td>2026. 1. 30 16:30:18</td>
                    <td class="normal">6시간 7분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>윤성구</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:51:13</td>
                    <td>2026. 1. 30 17:20:41</td>
                    <td class="normal">7시간 41분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이동구</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:20:19</td>
                    <td>2026. 1. 30 17:03:09</td>
                    <td class="normal">7시간 23분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이종광</td>
                    <td>현장</td>
                    <td>2026. 1. 30 16:33:00</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이효주</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:56:24</td>
                    <td>2026. 1. 30 17:02:02</td>
                    <td class="normal">7시간 22분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>전준룡</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:21:48</td>
                    <td>2026. 1. 30 16:56:26</td>
                    <td class="normal">7시간 16분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>최선희</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:42:26</td>
                    <td>2026. 1. 30 16:56:09</td>
                    <td class="normal">7시간 16분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>황금산</td>
                    <td>현장CHI</td>
                    <td>2026. 1. 30 7:36:41</td>
                    <td>2026. 1. 30 16:30:53</td>
                    <td class="normal">6시간 51분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>황익재</td>
                    <td>본사</td>
                    <td>2026. 1. 30 8:01:42</td>
                    <td>2026. 1. 30 15:54:28</td>
                    <td class="normal">6시간 13분</td>
                    <td>아니오</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_4')">
                <div>
                    <h3>🏗️ TMS(M) (총 14명: 본사 1명, 현장 13명)</h3>
                    <small style="opacity: 0.8;">상세: 본사 1명, 현장 13명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 4명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_4">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('TMS(M)', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>강정철</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:07:25</td>
                    <td>2026. 1. 30 16:54:08</td>
                    <td class="normal">7시간 7분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김도형</td>
                    <td>본사</td>
                    <td>2026. 1. 30 8:00:32</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>김성권</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:35:09</td>
                    <td>2026. 1. 30 16:52:53</td>
                    <td class="normal">7시간 13분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>서정환</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:00:25</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>양윤</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:53:39</td>
                    <td>2026. 1. 30 16:54:07</td>
                    <td class="normal">7시간 14분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>엄용국</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:39:09</td>
                    <td>2026. 1. 30 16:53:12</td>
                    <td class="normal">7시간 13분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이대균</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:54:38</td>
                    <td>2026. 1. 30 16:53:54</td>
                    <td class="normal">7시간 14분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이동민</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:08:38</td>
                    <td>2026. 1. 30 16:53:29</td>
                    <td class="normal">7시간 13분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이선만</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:00:18</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이성균</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:52:54</td>
                    <td>2026. 1. 30 16:53:37</td>
                    <td class="normal">7시간 14분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이용</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:50:40</td>
                    <td>2026. 1. 30 12:12:47</td>
                    <td class="normal">3시간 0분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이용희</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:00:39</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>지화</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:51:41</td>
                    <td>2026. 1. 30 12:11:47</td>
                    <td class="normal">3시간 0분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>최동호</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:28:44</td>
                    <td>2026. 1. 30 16:53:41</td>
                    <td class="normal">7시간 14분</td>
                    <td>아니오</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_5')">
                <div>
                    <h3>⚡ P&S (총 12명: 본사 5명, 현장 7명)</h3>
                    <small style="opacity: 0.8;">상세: 본사 5명, 현장 7명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 6명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_5">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('P&S', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>강기준</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:59:15</td>
                    <td>2026. 1. 30 16:41:59</td>
                    <td class="normal">7시간 2분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>김홍매</td>
                    <td>본사</td>
                    <td>2026. 1. 30 16:54:27</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>남민수</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:05:47</td>
                    <td>2026. 1. 30 16:54:18</td>
                    <td class="normal">7시간 9분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박광진</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:03:19</td>
                    <td>2026. 1. 30 16:42:27</td>
                    <td class="normal">6시간 59분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>박동길</td>
                    <td>현장</td>
                    <td>2026. 1. 30 8:05:32</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>왕신국</td>
                    <td>현장</td>
                    <td>2026. 1. 30 9:03:03</td>
                    <td>2026. 1. 30 16:42:14</td>
                    <td class="normal">5시간 59분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>이옥매</td>
                    <td>본사</td>
                    <td>2026. 1. 30 8:00:20</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>이운</td>
                    <td>본사</td>
                    <td>2026. 1. 30 7:57:05</td>
                    <td>2026. 1. 30 16:54:32</td>
                    <td class="normal">7시간 15분</td>
                    <td>아니오</td>
                </tr>
            
                <tr>
                    <td>정민호</td>
                    <td>현장</td>
                    <td>2026. 1. 30 7:56:35</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>조홍연</td>
                    <td>본사</td>
                    <td>2026. 1. 30 8:15:13</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>주용범</td>
                    <td>본사</td>
                    <td>2026. 1. 30 8:00:13</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                <tr>
                    <td>최윤철</td>
                    <td>현장</td>
                    <td>2026. 1. 30 9:06:16</td>
                    <td>2026. 1. 30 16:43:47</td>
                    <td class="normal">5시간 58분</td>
                    <td>아니오</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
        <div class="company-section">
            <div class="company-header" onclick="toggleCompany('company_6')">
                <div>
                    <h3>🏢 NONE (총 1명: 본사 0명, 현장 1명)</h3>
                    <small style="opacity: 0.8;">상세: 현장 1명</small>
                </div>
                <div>
                    <span class="summary-badge">퇴근미체크: 1명</span>
                    <span class="toggle-icon">▼</span>
                </div>
            </div>
            <div class="company-content" id="company_6">
                <div class="date-buttons">
                    📅 일자별 CSV 다운로드 (최근 7일):
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_30')">1월 30일</button>
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_29')">1월 29일</button>
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_28')">1월 28일</button>
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_27')">1월 27일</button>
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_26')">1월 26일</button>
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_25')">1월 25일</button>
                    <button class="date-btn" onclick="downloadCSV('NONE', '2026_01_24')">1월 24일</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>이름</th>
                            <th>담당 업무</th>
                            <th>출근 시간</th>
                            <th>퇴근 시간</th>
                            <th>근무시간</th>
                            <th>퇴근미체크</th>
                        </tr>
                    </thead>
                    <tbody>
                        
                <tr>
                    <td>정진수</td>
                    <td>현장</td>
                    <td>2026. 1. 30 16:58:17</td>
                    <td><span class="missing">미체크</span></td>
                    <td class="missing">0시간 0분</td>
                    <td>예</td>
                </tr>
            
                    </tbody>
                </table>
            </div>
        </div>
        
    </div>

    <script>
                 // 차트 데이터 (단순화 - 본사 vs 현장)
         var companies = ["BAT", "C&A", "FNI", "TMS(E)", "TMS(M)", "P&S", "NONE"];
         var totals = [25, 24, 23, 23, 14, 12, 1];
         var hq_total_counts = [0, 11, 0, 11, 1, 5, 0];
         var factory_total_counts = [25, 13, 23, 12, 13, 7, 1];
         
         // 협력사별 색상 정의
         var companyColors = {
             'BAT': ['#FF6B6B', '#FF8E8E'],      // 빨간색 계열
             'C&A': ['#4ECDC4', '#7ED7D1'],      // 청록색 계열
             'FNI': ['#45B7D1', '#6BC5D8'],      // 파란색 계열
             'P&S': ['#96CEB4', '#AFDCC4'],      // 녹색 계열
             'TMS(E)': ['#FFEAA7', '#FFF2C7'],   // 노란색 계열
             'TMS(M)': ['#DDA0DD', '#E6B8E6'],   // 보라색 계열
             'TEST': ['#FFB347', '#FFC470']      // 오렌지색 계열
         };
         
         // 기본 색상 (정의되지 않은 회사용)
         var defaultColors = ['#95A5A6', '#BDC3C7'];
         
         // 협력사별 색상 배열 생성
         var factoryColors = [];
         var hqColors = [];
         
         companies.forEach(function(company) {
             var colors = companyColors[company] || defaultColors;
             factoryColors.push(colors[0]); // 현장용 색상 (진한색)
             hqColors.push(colors[1]);      // 본사용 색상 (연한색)
         });
         
         // 막대 차트 생성 (본사 vs 현장)
         var trace1 = {
             x: companies,
             y: factory_total_counts,
             name: '현장',
             type: 'bar',
             marker: { color: factoryColors }
         };
         
         var trace2 = {
             x: companies,
             y: hq_total_counts,
             name: '본사',
             type: 'bar',
             marker: { color: hqColors }
         };
        
        var layout = {
            title: '협력사별 출입 현황 (2026. 1. 30)',
            xaxis: { title: '회사명' },
            yaxis: { title: '인원 수' },
            barmode: 'stack',
            font: { family: 'Malgun Gothic, sans-serif' },
            dragmode: false
        };
        
        var config = {
            displayModeBar: false,
            scrollZoom: false,
            doubleClick: false,
            showTips: false,
            staticPlot: false,
            dragmode: false
        };
        
        Plotly.newPlot('bar-chart', [trace1, trace2], layout, config);
        
        // 회사 섹션 토글
        function toggleCompany(companyId) {
            var content = document.getElementById(companyId);
            var icon = document.querySelector(`[onclick="toggleCompany('${companyId}')"] .toggle-icon`);
            
            if (content.classList.contains('active')) {
                content.classList.remove('active');
                icon.classList.remove('active');
            } else {
                content.classList.add('active');
                icon.classList.add('active');
            }
        }
        
        // GitHub JSON에서 CSV 다운로드 함수
        async function downloadCSV(company, dateStr) {
            try {
                // 날짜 형식 그대로 사용 (이미 YYYY_MM_DD 형식)
                const githubDate = dateStr;
                
                // GitHub raw URL 생성 (URL 인코딩 추가)
                const encodedCompany = encodeURIComponent(company);
                const githubUrl = `https://raw.githubusercontent.com/isolhsolfafa/gst-factory/main/public/daily_data/${encodedCompany}_${githubDate}.json`;
                    
                    // JSON 데이터 가져오기
                    console.log('GitHub URL:', githubUrl);  // 디버깅용
                    const response = await fetch(githubUrl);
                    if (!response.ok) {
                        alert('데이터를 찾을 수 없습니다: ' + company + ' ' + dateStr + '\n' + githubUrl);
                        return;
                    }
                    
                    const jsonData = await response.json();
                    
                    // CSV 변환
                    const csvContent = convertToCSV(jsonData);
                    
                    // CSV 다운로드
                    const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
                    const link = document.createElement('a');
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', `${company}_${dateStr}.csv`);
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
            } catch (error) {
                console.error('CSV 다운로드 오류:', error);
                alert('CSV 다운로드 중 오류가 발생했습니다.');
            }
        }

        // JSON을 CSV로 변환하는 함수
        function convertToCSV(jsonData) {
            if (!jsonData || jsonData.length === 0) {
                return '데이터가 없습니다.';
            }
            
            // CSV 헤더 (UTF-8 BOM 추가)
            const headers = ['이름', '담당 업무', '출근 시간', '퇴근 시간', '근무시간(H:M)', '퇴근미체크', '날짜', '회사명'];
            let csvContent = '\uFEFF' + headers.join(',') + '\n';
            
            // 데이터 행 추가
            jsonData.forEach(item => {
                const row = [
                    item['이름'] || '',
                    item['담당 업무'] || '',
                    item['출근 시간'] || '',
                    item['퇴근 시간'] || '',
                    item['근무시간(H:M)'] || '',
                    item['퇴근미체크'] ? '예' : '아니오',
                    item['날짜'] || '',
                    item['회사명'] || ''
                ];
                
                // CSV 특수문자 처리 (쉼표, 따옴표, 줄바꿈)
                const escapedRow = row.map(field => {
                    if (typeof field === 'string' && (field.includes(',') || field.includes('"') || field.includes('\n'))) {
                        return '"' + field.replace(/"/g, '""') + '"';
                    }
                    return field;
                });
                
                csvContent += escapedRow.join(',') + '\n';
            });
            
            return csvContent;
        }
        
        // 첫 번째 회사 자동 열기 (비활성화)
        // if (companies.length > 0) {
        //     toggleCompany('company_0');
        // }
    </script>
</body>
</html>
