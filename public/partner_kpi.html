
    <!DOCTYPE html>
    <html lang="ko">
    <head>
        <meta charset="UTF-8">
        <title>í˜‘ë ¥ì‚¬ KPI ëŒ€ì‹œë³´ë“œ</title>
        
    <style>
        .chart-section { margin: 10px; }
        .kpi-container { display: flex; flex-wrap: wrap; justify-content: center; }
        .kpi-card { 
            width: 130px; height: 130px; margin: 10px; 
            background: #f8f9fa; border-radius: 8px; 
            display: flex; flex-direction: column; align-items: center; justify-content: center; 
            position: relative; box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
            cursor: pointer;
        }
        .emoji { font-size: 2em; }
        .label { font-size: 1.2em; font-weight: bold; }
        .tooltip { 
            visibility: hidden; width: 200px; background-color: #555; color: #fff; 
            text-align: center; border-radius: 6px; padding: 5px; 
            position: absolute; z-index: 1; top: 100%; left: 50%; 
            transform: translateX(-50%); opacity: 0; transition: opacity 0.3s; 
        }
        .kpi-card:hover .tooltip { visibility: visible; opacity: 1; }
        .defect-table { 
            width: 100%; max-width: 600px; margin: 10px auto; border-collapse: collapse; 
            background: #fff; box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
        }
        .defect-table th, .defect-table td { 
            border: 1px solid #ddd; padding: 8px; text-align: left; 
        }
        .defect-table th { background-color: #f2f2f2; }
        .hidden { display: none; }
        .download-btn { 
            margin: 10px 0; 
            padding: 5px 10px; 
            background-color: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
        }
        .download-btn:hover { background-color: #45a049; }
    </style>
    
        <script>
            const defectDetails = {"BAT": [{"productInfo": "41100502 / GAIA-I", "defect": "N2 Male Connector Teflon ë¶€ ë°€ë¦¼ìœ¼ë¡œ Leak ì˜ì‹¬ , Teflon ì¶”ê°€ ì‘ì—… í›„ ì¬ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200101 / GAIA-I DUAL", "defect": "PUMP NUT 25A ì‚¬ì„ ì²´ê²°Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200074 / GAIA-II DUAL", "defect": "PCW UNION ELBOW 08 Fitting Nut ì²´ê²° ëˆ„ë½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200047 / GAIA-I DUAL", "defect": "Right Circulation Wet Line Nut ë¶€ Leak ë°œìƒ", "action": "Nut ë¶€ ì¬ì²´ê²°"}, {"productInfo": "41200084 / GAIA-II", "defect": "O2 Pnuematic Valve VNB104AS-8A Pilot ì—­ë°©í–¥ ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200084 / GAIA-II", "defect": "O2 Pnuematic Valve VNB104AS-8A Pilot ì—­ë°©í–¥ ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200084 / GAIA-II", "defect": "O2 Pnuematic Valve VNB104AS-8A Pilot ì—­ë°©í–¥ ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200033 / GAIA-I DUAL", "defect": "LNG ì—°ê²° N2 MALE BANJO PH 08-02 Tube ì‚½ì… ë¶ˆëŸ‰", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200035 / GAIA-I DUAL", "defect": "420A Solenoid V/v ì—­ë°©í–¥ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200118 / GAIA-I SINGLE", "defect": "O2 ì£¼ì… Bulkhead Union Fitting Nut ë¯¸ì™„ì²´ê²° Leak", "action": "ì¶”ê°€ì²´ê²°"}, {"productInfo": "41000587 / DRAGON AB DUAL", "defect": "ë°°ê´€ ì—°ê²° N2 Purge Fitting Nut ë¯¸ì™„ì²´ê²° Leak", "action": "ì™„ì²´ê²°"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "N2 Male Connector KQ2H08-03NS Teflon ì²´ê²°ë¶€ Leak", "action": "Teflon ì¶”ê°€ ì‘ì—… í›„ ì¬ì²´ê²°"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "N2 Male Connector Teflon KQ2H08-03NS ì²´ê²°ë¶€ Leak", "action": "Teflon ì¶”ê°€ ì‘ì—… í›„ ì¬ì²´ê²°"}, {"productInfo": "41200047 / GAIA-I DUAL", "defect": "Exhaust Clamp(125A) ì²´ê²°ë¶ˆëŸ‰ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000587 / DRAGON AB DUAL", "defect": "BCW Male Elbow 40-6-4-P-PG Nut í˜ëŸ´ì°¢ì–´ì§ìœ¼ë¡œ ì¸í•œ Leak", "action": "í˜ëŸ´êµì²´"}, {"productInfo": "41100372 / GAIA-I DUAL", "defect": "LNG LINE KEY OPERATION VALVE KEY OPERATION VALVE NUT LEAK (HV 200A)", "action": "FITTING NUT ì¬ì²´ê²°"}, {"productInfo": "41100375 / GAIA-I", "defect": "Exhaust Clamp(125A) ì²´ê²°ë¶€ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41100317 / GAIA-I DUAL", "defect": "Left Circulation Quench Line Nut ë¶€ Leak ë°œìƒ", "action": "Nut ë¶€ ì¬ì¡°ë¦½"}, {"productInfo": "41100372 / GAIA-I DUAL", "defect": "Process#3 ë°°ê´€ Clamp NW40 Leak", "action": "ì¬ì²´ê²°"}, {"productInfo": "41100372 / GAIA-I DUAL", "defect": "Exhaust Clamp(125A) Leak - ë²¤ì¸„ë¦¬ í™•ì¸ì„ ìœ„í•œ ì¬ì‘ì—…, í•´ë‹¹ë¶€ íƒˆì°©ì‹œ O-ring í™•ì¸ ì–´ë ¤ì›€", "action": "ì¬ì²´ê²°"}, {"productInfo": "41200061 / GAIA-P DUAL", "defect": "Drain Line I-Marking ëˆ„ë½ ë° ì´‰ìˆ˜ ê²€ì‚¬ ì‹œ í’€ë¦¼", "action": ""}, {"productInfo": "41200061 / GAIA-P DUAL", "defect": "BCW Air Sol V/V ì—°ê²° Male Connector Leak", "action": "í…Œí“¨ë¡  ì‘ì—… í›„ ì¬ì¡°ë¦½"}, {"productInfo": "41200104 / GAIA-I DUAL", "defect": "PCW BULKHEAD UNION BU-12 Fitting Nut ë¯¸ì™„ì²´ê²°", "action": "ì²´ê²°"}, {"productInfo": "41200104 / GAIA-I DUAL", "defect": "Main N2 Elbow Union Fitting Nut Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200005 / GAIA-I", "defect": "PCW Sus Tube Fitting Nut Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200008 / DRAGON AB DUAL", "defect": "BCW Flow Sensor Manifold Jaco Fitting Nut ë¯¸ì™„ì²´ê²°", "action": "ì¶”ê°€ì²´ê²°"}, {"productInfo": "41000556 / GAIA-I DUAL", "defect": "ë¯¸ë‹ˆì—´êµí™˜ê¸° BCW ì—°ê²° Female Connector ë‚˜ì‚¬ì‚° íŒŒì†ìœ¼ë¡œ ì¸í•œ Leak", "action": "íŒŒíŠ¸êµì²´(ë¯¸ë‹ˆ ì—´êµí™˜ê¸° , Female Connector 4ea)"}, {"productInfo": "41000588 / DRAGON AB DUAL", "defect": "BCW Jaco Elbow Union Fitting Nut Leak", "action": "íŒŒíŠ¸êµì²´"}, {"productInfo": "41200007 / GAIA-I", "defect": "Swirl Line manifold teflon ë¶€ Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "PCW Flow Sensor í•˜ë‹¨ë¶€ Male Connector Fitting Nut Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Manifold Swirl Line Teflon ë¶€ Leak", "action": "Teflon ì¬ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Manifold teflon ë¶€ Leak", "action": "Teflon ì¬ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Temp Sensor T01 PFA Tube ë¯¸ì—°ê²°", "action": "ì—°ê²°"}, {"productInfo": "41200007 / GAIA-I", "defect": "Sprinkler Male Connector Teflon ì²´ê²°ë¶€ Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Sprinkler Male Connector Teflon ì²´ê²°ë¶€ Leak", "action": "Teflon ì¬ì‘ì—… , ì›ì¸ë¶ˆëª…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Sprinkler Male Connector Teflon ì²´ê²°ë¶€ Leak", "action": "Teflon ì¬ì‘ì—… , ì›ì¸ë¶ˆëª…"}, {"productInfo": "41200007 / GAIA-I", "defect": "PCW Line Union Tee(080806) ìƒë‹¨ Fitting Nut Leak", "action": "ê°­ê²Œì´ì§€ ë° í˜ëŸ´ ì´ìƒì—†ìŒ , íŒŒíŠ¸êµì²´"}, {"productInfo": "41200007 / GAIA-I", "defect": "Sprinkler Male Connector Teflon ì²´ê²°ë¶€ Leak", "action": "Teflon ì¬ì‘ì—… , ì›ì¸ë¶ˆëª…"}, {"productInfo": "41200005 / GAIA-I", "defect": "í´ë¦¬ë‹ ìƒíƒœë¶ˆëŸ‰, ìì¼“ì— ë§ˆí‚¹ ì˜¤ì—¼", "action": ""}, {"productInfo": "41200005 / GAIA-I", "defect": "CHECK VALVE SS-IHCV-06M-1PSI Nut ë¯¸ì™„ì²´ê²°ë¡œ ì¸í•œ Leak", "action": "ì²´ê²°"}, {"productInfo": "41200005 / GAIA-I", "defect": "N2 Speed Controller Manifold ì—°ê²° MALE STRAIGHT PC 08-04 ì²´ê²° ê°•ë„ ë¶€ì¡± Leak", "action": "ì¶”ê°€ì²´ê²°"}, {"productInfo": "41100320 / GAIA-I DUAL", "defect": "LNG Line KEY OPERATION VALVE V81C-D-6T-KB-S(HV200A) Fitting Nut ë¯¸ì™„ì²´ê²°", "action": "ì²´ê²°"}, {"productInfo": "41100320 / GAIA-I DUAL", "defect": "O2 Line KEY OPERATION VALVE V81C-D-6T-KB-S(HV300A) Fitting Nut ë¯¸ì™„ì²´ê²°", "action": "ì²´ê²°"}, {"productInfo": "41200007 / GAIA-I", "defect": "Heating PAB Pipe #1 í¬ì¥ì¬ ë¯¸ì œê±°", "action": "í¬ì¥ì¬ ì œê±°"}, {"productInfo": "41200007 / GAIA-I", "defect": "Main N2 ë°˜ì¡° Elbow í…Œí“¨ë¡ ë¶€ Leak", "action": "í…Œí“¨ë¡  ì¬ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Sprinkler Male Connector í…Œí“¨ë¡ ë¶€ Leak", "action": "í…Œí“¨ë¡  ì¬ì‘ì—…"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "ë°°ê´€ CLAMP NW40 ë¯¸ì™„ì²´ê²°", "action": "íˆíŒ…ìì¼“ í•´ì²´ ë° ë°°ê´€ íƒˆê±°í›„ í´ë¨í”„ ì¬ì²´ê²°"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "CIR WATER LINE PP Nut ë‚´ë¶€ O-Ring ì²´ê²° ë¶ˆëŸ‰", "action": "PP Nut O-Ring ì¬ì¡°ë¦½"}, {"productInfo": "41200076 / GAIA-I DUAL", "defect": "BCW BULKHEAD UNION BU-08 í•˜ë‹¨ë¶€ Fitting Nut Leak / íŠœë¸Œ ê¸¸ì´ ë¶€ì¡±", "action": "íŠœë¸Œ êµì²´"}, {"productInfo": "41200076 / GAIA-I DUAL", "defect": "BRAZED PLATE HEAT EXCHANGER Female Connector FC08-12R ì¡°ë¦½ë¶ˆëŸ‰", "action": "íŒŒíŠ¸êµì²´"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "CENTER O-RING MEX70B(FKM-F BROWN) NW40ì´íƒˆ", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000514 / DRAGON LE DUAL", "defect": "CENTRIFUGAL PUMP WPIV-1560-G3-B-IE3 ë³¼íŠ¸ ì²´ê²°ë¶€ Leak", "action": "ì¶”ê°€ ì²´ê²°"}, {"productInfo": "41000514 / DRAGON LE DUAL", "defect": "HEAT EXCHANGER CAM030x30-SMO254-06T-PVC32A_ARK PP Nut Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41100435 / WET 1000", "defect": "Drain Lineå…§ ì´ë¬¼ì§ˆë¡œ ì¸í•œ Drain ë¶ˆê°€", "action": "ì´ë¬¼ì§ˆ ì œê±° í›„ ì¬ì¡°ë¦½"}, {"productInfo": "41200085 / GAIA-P20", "defect": "UNION ELBOW 50-8-K-PG Fitting Nut Leak", "action": "ì¬ì²´ê²°"}], "FNI": [{"productInfo": "41200124 / GAIA-I DUAL", "defect": "GN2 ì£¼ì… BULKHEAD UNION 08 í•˜ë‹¨ë¶€ Fittng Nut Leak / ì¬ì¡°ë¦½ ì‹œì—ë„ ë™ì¼ì¦ìƒìœ¼ë¡œ Nut ë° SUS TUBEêµì²´", "action": "íŒŒíŠ¸êµì²´"}, {"productInfo": "41200080 / GAIA-I DUAL", "defect": "Left, Right BCW Line Teflon ë¶€ Leak ë°œìƒ(2Point)", "action": "Teflon ì¬ì‘ì—…"}, {"productInfo": "41200080 / GAIA-I DUAL", "defect": "GN2 BULK HEAD UNION í•˜ë‹¨ë¶€ Fitting Nut ë¯¸ì™„ì²´ê²°", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000590 / DRAGON AB SINGLE", "defect": "Tank Bubble Tubing ì˜¤ì¡°ë¦½(YV472<>YV474)", "action": "Tubing ì¬ì²´ê²°"}, {"productInfo": "41200036 / GAIA-I DUAL", "defect": "125A Clamp ë‚´ë¶€ O-Ring ì´íƒˆë¡œ ì¸í•œ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "N2 Purge N.PE120 CHECK VALVE Fitting Nut ì²´ê²° ëˆ„ë½", "action": "ì²´ê²°"}, {"productInfo": "41200027 / GAIA-I", "defect": "N2 Pressure Sensor TEFLON GASKET ì‚¬ìš© ë¶€ Leak / ì¬ì¡°ë¦½ í›„ ì´ìƒì—†ìŒ í™•ì¸", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200080 / GAIA-I DUAL", "defect": "ADJUSTABLE ELBOW Fitting Nut Leak(ê°­ê²Œì´ì§€ ì´ìƒ ë¬´ , ì²´ê²°ê°•ë„ ì´ìƒ ë¬´)", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200101 / GAIA-I DUAL", "defect": "PM Cycle Sol Valve Tube ëˆ„ë½(PM Cycle ë™ì‘ ë¶ˆê°€)", "action": "Tube ì‘ì—…"}, {"productInfo": "41200101 / GAIA-I DUAL", "defect": "Main N2 Male Connector KQ2H08-03NS Teflon ì¡°ë¦½ë¶€ Leak ( Teflon ì½”íŒ… í›„ ì…ê³  íŒŒíŠ¸)", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200101 / GAIA-I DUAL", "defect": "Main N2 Male Connector KQ2H08-03NS Teflon ì¡°ë¦½ë¶€ Leak ( Teflon ì½”íŒ… í›„ ì…ê³  íŒŒíŠ¸)", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200101 / GAIA-I DUAL", "defect": "PUMP NUT 25A ì²´ê²°ê°•ë„ ë¶€ì¡± Leak", "action": "ì¬ì²´ê²°"}, {"productInfo": "41200101 / GAIA-I DUAL", "defect": "UNION ELBOW UE06M Fitting Nut ì²´ê²°ë¶ˆëŸ‰ Leak", "action": "ì¬ì²´ê²°"}, {"productInfo": "41200096 / GAIA-P", "defect": "PCW(R) REDUCING UNION TEE RT12-12-06 Fitting Nut ì²´ê²°ê°•ë„ë¶€ì¡± Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "PCW(R) Check Valve Out ë‹¨ ì—°ê²° Male AdapterMA 12-12R êµ¬ë¦¬ìŠ¤ ë„í¬ ë¶€ì¡±", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "Drain Line UNION NUT _20A_20A PP ë‚´ë¶€ O-Ring ì²´ê²°ë¶ˆëŸ‰ Leak", "action": "ì¬ì²´ê²°"}, {"productInfo": "41200074 / GAIA-II DUAL", "defect": "PCW-R Edjustable Elbow Fitting Nut Ferrule ì¡°ë¦½ë¶€ Leak", "action": "Adjustable Elbow íŒŒíŠ¸ ë° Nut , Ferrule êµì²´"}, {"productInfo": "41200108 / GAIA-P", "defect": "N2 N.SCR-140 Screw Scrapper ë°˜ì¡° ì—°ê²° PFA Tube Cutting ë¶ˆëŸ‰ìœ¼ë¡œ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200118 / GAIA-I SINGLE", "defect": "Drain Line ê³µì•• ë°¸ë¸Œ ë°˜ì¡° ì¡°ë¦½ ìœ„ì¹˜ ë¶ˆëŸ‰", "action": "ì¬ì²´ê²°"}, {"productInfo": "41200006 / GAIA-II", "defect": "Cir' 2nd Quench Line Nut ë¶€ë¶„ Water Leak ë°œìƒ", "action": "ì¬ì‘ì—… í›„ ì •ìƒ í™•ì¸"}, {"productInfo": "41100334 / GAIA-I DUAL", "defect": "PCW(R) Flow Sensor í•˜ë‹¨ë¶€ Male Adapter MA12-12R ë½íƒ€ì´íŠ¸ ë„í¬ ë¶€ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "ë°°ê´€ ì—°ê²° BALL VALVE SS-BL-04TR-1(BLACK) ì¡°ë¦½ ëˆ„ë½", "action": "ì¡°ë¦½"}, {"productInfo": "41200006 / GAIA-II", "defect": "H/J Cable ë™ì„ ìœ¼ë¡œ ì¸í•˜ì—¬ Cover ì¥ì°© ë¶ˆê°€", "action": ""}, {"productInfo": "41200006 / GAIA-II", "defect": "PCW Quick Coupler í…Œí“¨ë¡ ë¶€ Leak", "action": "í…Œí“¨ë¡  ì¶”ê°€ ì‘ì—…"}, {"productInfo": "41200007 / GAIA-I", "defect": "Manifold ì¡°ë¦½ Speed Controller ë¯¸ì™„ì²´ê²°", "action": "ì¶”ê°€ì²´ê²°"}, {"productInfo": "41200005 / GAIA-I", "defect": "CIR' Line Maniford ì—°ê²° ë¶€ 2 Point ë¯¸ì„¸ Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41000584 / DRAGON AB DUAL", "defect": "Exhaust Chain Clamp ì²´ê²°ë¶€ Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41000590 / DRAGON AB SINGLE", "defect": "BCW Jaco Fitting Nut Leak 2ea", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000590 / DRAGON AB SINGLE", "defect": "BCW Jaco Fitting Nut Leak 2ea", "action": "ì¬ì‘ì—…"}, {"productInfo": "41100320 / GAIA-I DUAL", "defect": "N2 Male Connector(ê³µì••) ì²´ê²°ë¶€ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000556 / GAIA-I DUAL", "defect": "BYPASS#4 3Way V/V í•˜ë‹¨ë¶€ Flange í‹€ì–´ì§ìœ¼ë¡œ ì¸í•œ Clamp Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200087 / GAIA-I DUAL", "defect": "BYPASS#4 Clamp ì²´ê²°ë¶€ Flange ë©´ í‹€ì–´ì§ìœ¼ë¡œ ì¸í•œ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000598 / GAIA-P DUAL", "defect": "Right Circulation Line Nutë¶€ Leak ë°œìƒ", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200095 / GAIA-I", "defect": "VENTURI NOZZLE FLANGE CAP ì²´ê²°ê°„ Teflon ë¶€ Leak", "action": "Teflon ì¬ì‘ì—…"}, {"productInfo": "41200076 / GAIA-I DUAL", "defect": "Main N2 ì—°ê²° Male Connector Fitting ì²´ê²°ë¶€ Leak / ì²´ê²°ê°•ë„ ì´ìƒ ì—†ìŒ", "action": "ì¬ì¡°ë¦½ ì‹œ Leak ì—†ìŒ í™•ì¸ ( ì›ì¸ë¶ˆëª…)"}, {"productInfo": "41200103 / DRAGON AB", "defect": "BCW Jaco Union Fitting Nut Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200103 / DRAGON AB", "defect": "Exhaust ì—°ê²° Chain Clamp ì²´ê²° ë¶ˆëŸ‰", "action": "ì¶”ê°€ ì²´ê²°"}, {"productInfo": "41000514 / DRAGON LE DUAL", "defect": "BCW Jaco Fitting Nut Leak (ì›ì¸ë¶ˆëª…)", "action": "ì¶”ê°€ì²´ê²°"}, {"productInfo": "41000514 / DRAGON LE DUAL", "defect": "LNG ëë‹¨ N2 ì—°ê²° ê³µì••Sol V/V ì—°ê²° ë°˜ì¡° Elbow Fitting ì²´ê²°ë¶€ Leak", "action": "íŒŒíŠ¸êµì²´"}, {"productInfo": "41200027 / GAIA-I", "defect": "Wet Line ManiFold Teflonë¶€ Leak", "action": "Teflon ì¬ì‘ì—…"}, {"productInfo": "41200027 / GAIA-I", "defect": "Circulation Line Nut Teflon ë¶€ Leak", "action": "Nutë¶€ ì¬ì¡°ë¦½"}], "TMS(M)": [{"productInfo": "41200046 / GAIA-I DUAL", "defect": "CIR WATER LINE UNION TEE Fitting Nut (PP) Tube ì‚½ì…ë¶ˆëŸ‰ LEAK", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41100696 / DRAGON AB DUAL", "defect": "MALE ELBOW Nut Tube ì‚½ì…ë¶ˆëŸ‰ / Ferrule ì¬ì¡°ë¦½ í›„ ê°€ì••", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41000587 / DRAGON AB DUAL", "defect": "SWIRL GUIDE AIR NOZZLE O-RING ì”¹í˜ìœ¼ë¡œ Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200119 / GAIA-I DUAL", "defect": "Right Inlet#3 Open<> Close Tubing ì˜¤ì¡°ë¦½", "action": "Tubing ì¬ì‘ì—…"}, {"productInfo": "41200119 / GAIA-I DUAL", "defect": "Main N2 Male Connector í…Œí“¨ë¡ ë¶€ Leak / íŒŒíŠ¸ í…Œí“¨ë¡  ë°€ë¦¼ ì˜ì‹¬ , í…Œí“¨ë¡  ì¶”ê°€ì‘ì—… í›„ ì¬ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200119 / GAIA-I DUAL", "defect": "Main N2 Male Connector í…Œí“¨ë¡ ë¶€ Leak / íŒŒíŠ¸ í…Œí“¨ë¡  ë°€ë¦¼ ì˜ì‹¬ , í…Œí“¨ë¡  ì¶”ê°€ì‘ì—… í›„ ì¬ì¡°ë¦½", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200119 / GAIA-I DUAL", "defect": "BCW ì—´êµí™˜ê¸° ì—°ê²° FEMALE ADAPTER Fitting Nut Leak / ì²´ê²° ìƒíƒœ ì´ìƒ ì—†ìŒ", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "PCW(S) Flow Sensor Outë‹¨ Male Connector ë½íƒ€ì´íŠ¸ ë¶€ì¡±", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "PCW Flow Sensor Inë‹¨ ì¡°ë¦½ MALE CONNECTOR MC12-12R êµ¬ë¦¬ìŠ¤ ë„í¬ ë¶€ì¡± Leak", "action": "ì¬ì¡°ë¦½"}, {"productInfo": "41200096 / GAIA-P", "defect": "PCW Flow Sensor Inë‹¨ ì¡°ë¦½ MALE CONNECTOR MC12-12R êµ¬ë¦¬ìŠ¤ ë„í¬ ë¶€ì¡± Leak", "action": "ì¬ì¡°ë¦½"}], "P&S": [{"productInfo": "41100320 / GAIA-I DUAL", "defect": "WLSF10A ë„˜ë²„ë§íŠœë¸Œ ì˜¤ê¸°", "action": "ì¬ì‘ì—…"}], "TMS(E)": [{"productInfo": "41200080 / GAIA-I DUAL", "defect": "Left Inlet Temp ì˜¤ì¡°ë¦½ (Inlet#3 <> #4)", "action": "ì¬ì¡°ë¦½ í™•ì¸"}, {"productInfo": "41200117 / GAIA-P DUAL", "defect": "1ë²ˆ 3-Way Valve Open Connector ë¯¸ì™„ì²´ê²°ë¡œ ì¸ì‹ë¶ˆê°€ë¡œ ì¸í•œ Alarm ë°œìƒ", "action": "ì¬ì‘ì—… í›„ ì •ìƒ í™•ì¸"}, {"productInfo": "42100281 / EES-08-D", "defect": "ì••ë ¥ì„¼ì„œ ì¶œë ¥ ë¶ˆëŸ‰", "action": "ëŒ€ì²´í’ˆ êµì²´"}, {"productInfo": "41200116 / GAIA-P", "defect": "ì „ë ¥ëŸ‰ê³„ Coil ì¥ì°© ìœ„ì¹˜ ì˜¤ë¥˜ _ ì •ìƒ: Main / ì‹¤ë¬¼: Sub = ì¸¡ì •ê°’ ì˜¤ë¥˜", "action": "í˜„ì¥ì¡°ì¹˜"}, {"productInfo": "41000584 / DRAGON AB DUAL", "defect": "H/H Sensor ì²´ê²°ë¶€ Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200103 / DRAGON AB", "defect": "Level Sensor O-ring ì²´ê²°ë¶€ Leak", "action": "ì¬ì‘ì—…"}, {"productInfo": "42100234 / EES-08-SA", "defect": "ì••ë ¥ì„¼ì„œ ì¶œë ¥ ë¶ˆê°€", "action": "ëŒ€ì²´í’ˆ êµì²´"}, {"productInfo": "42100239 / EES-06-DL", "defect": "1Ch POU íŒŒì›Œ ì»¤ë„¥í„° Pump ê²°ì„  ì˜¤ë°°ì„ ", "action": "1Ch POU íŒŒì›Œ ì»¤ë„¥í„° Pump ê²°ì„  ì¬ì‘ì—…"}, {"productInfo": "42100281 / EES-08-D", "defect": "2CH ì••ë ¥ ì¸¡ì • ë¶ˆê°€", "action": "ëŒ€ì²´í’ˆ êµì²´"}, {"productInfo": "41200079 / GAIA-P DUAL", "defect": "ì „ì¥ Check Sheet ì‹¤ë¬¼ê³¼ ë¶ˆì¼ì¹˜(ì‹¤ë¬¼ CP121 ë¯¸ì¡´ì¬)", "action": "ì¬ ì‘ì—…"}], "C&A": [{"productInfo": "42200040 / ES-04", "defect": "Flow Sensor Converter ì¶œë ¥ë¶ˆëŸ‰(ì •ìƒ ë²”ìœ„: 0~5V, ì‹¤ë¬¼: 12V ì¶œë ¥)", "action": "ëŒ€ì²´í’ˆ êµì²´"}, {"productInfo": "41000598 / GAIA-P DUAL", "defect": "KRF01A, KRF10A ë°°ì„  ë°”ë€œìœ¼ë¡œ Cabinet Exhaust Alarm ë°œìƒ ì‹œ Water Leak Alarm ë°œìƒ", "action": "ì¬ì‘ì—…"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "Touch Screen, PLC ê°„ í†µì‹  ë¶ˆê°€", "action": "Cable ì¬ì‘ì—…"}, {"productInfo": "41200075 / GAIA-I DUAL", "defect": "UV-IR Connector ë¹„ì •ìƒ ì••ì°©ìœ¼ë¡œ ì¸í•œ ê°ì§€ ë¶ˆëŸ‰", "action": "í˜„ì¥ ì¡°ì¹˜"}, {"productInfo": "41100320 / GAIA-I DUAL", "defect": "MFC ì„¤ì •ê°’ ëŒ€ë¹„ ë†’ê²Œ ì¶œë ¥ë¨ Analog Module IFB2050A 3/G8 â†’ 4/-8 ì˜¤ë°°ì„ ", "action": "í˜„ì¥ ì¡°ì¹˜"}, {"productInfo": "42100260 / ED-1008R-LR", "defect": "CH1 MCCB4.2, ELCB4.2 OUTë‹¨ Sìƒ Cross ì‘ì—…", "action": "Cross ì‘ì—… ì›ë³µ"}, {"productInfo": "42200007 / EES-06-P", "defect": "ì°¨ë‹¨ê¸° LSì—ì„œ FUJIë¡œ ì˜¤ì¥ì°©", "action": "ì°¨ë‹¨ê¸° LSë¡œ ì¥ì°©"}, {"productInfo": "41200100 / GAIA-P DUAL", "defect": "LED Lamp ìƒì‹œ On _ TBD15A Short Bar ì˜¤ì ìš©", "action": "ìˆ˜ì • ì‘ì—…"}]};
            console.log("DEBUG: defectDetails:", defectDetails);

            const partnerToIdMap = {
                'BAT': 'bat',
                'FNI': 'fni',
                'TMS(M)': 'tmsm',
                'P&S': 'pns',
                'TMS(E)': 'tmse',
                'C&A': 'cna'
            };

            const idToPartnerMap = Object.fromEntries(
                Object.entries(partnerToIdMap).map(([partner, id]) => [id, partner])
            );

            function toggleDefectTable(partnerId) {
                const partner = idToPartnerMap[partnerId];
                console.log("DEBUG: Toggling table for partner:", partner);
                const table = document.getElementById(`defect-table-${partnerId}`);
                if (table.classList.contains('hidden')) {
                    table.classList.remove('hidden');
                    const details = defectDetails[partner] || [];
                    console.log("DEBUG: Details for partner:", partner, details);
                    let tableBody = '';
                    if (details.length === 0) {
                        tableBody = '<tr><td colspan="3">ë¶ˆëŸ‰ ë°ì´í„° ì—†ìŒ</td></tr>';
                    } else {
                        details.forEach(item => {
                            tableBody += `<tr><td>${item.productInfo}</td><td>${item.defect}</td><td>${item.action}</td></tr>`;
                        });
                    }
                    table.querySelector('tbody').innerHTML = tableBody;
                } else {
                    table.classList.add('hidden');
                }
            }

            function downloadCSV(partnerId) {
                const partner = idToPartnerMap[partnerId];
                const details = defectDetails[partner] || [];
                console.log("DEBUG: Downloading CSV for partner:", partner, details);
                if (details.length === 0) {
                    alert('ë‹¤ìš´ë¡œë“œí•  ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                    return;
                }

                let csvContent = 'ï»¿';
                csvContent += 'ì œí’ˆì •ë³´,ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©,ìƒì„¸ì¡°ì¹˜ë‚´ìš©\n';

                details.forEach(item => {
                    const row = [
                        `"${item.productInfo.replace(/"/g, '""')}"`,
                        `"${item.defect.replace(/"/g, '""')}"`,
                        `"${item.action.replace(/"/g, '""')}"`
                    ];
                    csvContent += row.join(',') + '\n';
                });

                const today = new Date();
                const dateStr = today.getFullYear() + '' + 
                               String(today.getMonth() + 1).padStart(2, '0') + '' + 
                               String(today.getDate()).padStart(2, '0');

                const fileName = `${partner}_ë¶ˆëŸ‰ë‚´ì—­_${dateStr}.csv`;

                const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8' });
                const url = window.URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.setAttribute('href', url);
                link.setAttribute('download', fileName);
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                window.URL.revokeObjectURL(url);
            }
        </script>
    </head>
    <body>
        <div class="chart-section">
            <h2 style="text-align: center;">ğŸ† ê¸°êµ¬ í˜‘ë ¥ì‚¬ KPI ì§€ìˆ˜</h2>
            <div class="kpi-container">
    
                <div class="kpi-card" onclick="toggleDefectTable('tmsm')">
                    <div class="emoji">ğŸ¥‡</div>
                    <div class="label">TMS(M)</div>
                    <div class="tooltip" id="tooltip-tmsm">
                        í‰ê°€ì ìˆ˜: 8.2 / Aë“±ê¸‰<br>
                        ë¶ˆëŸ‰ê±´ìˆ˜: 10ê±´<br>
                        ëˆ„ë½ë¹„ìœ¨: 0.1%
                    </div>
                </div>
        
                <div class="kpi-card" onclick="toggleDefectTable('bat')">
                    <div class="emoji">ğŸ¥ˆ</div>
                    <div class="label">BAT</div>
                    <div class="tooltip" id="tooltip-bat">
                        í‰ê°€ì ìˆ˜: 4.8 / Bë“±ê¸‰<br>
                        ë¶ˆëŸ‰ê±´ìˆ˜: 55ê±´<br>
                        ëˆ„ë½ë¹„ìœ¨: 0.4%
                    </div>
                </div>
        
                <div class="kpi-card" onclick="toggleDefectTable('fni')">
                    <div class="emoji">ğŸ¥‰</div>
                    <div class="label">FNI</div>
                    <div class="tooltip" id="tooltip-fni">
                        í‰ê°€ì ìˆ˜: 4.0 / Cë“±ê¸‰<br>
                        ë¶ˆëŸ‰ê±´ìˆ˜: 41ê±´<br>
                        ëˆ„ë½ë¹„ìœ¨: 6.3%
                    </div>
                </div>
        
            </div>
            <table id="defect-table-bat" class="defect-table hidden">
                <thead>
                    <tr>
                        <th colspan="3">
                            <button class="download-btn" onclick="downloadCSV('bat')">CSV ë‹¤ìš´ë¡œë“œ</button>
                        </th>
                    </tr>
                    <tr><th>ì œí’ˆì •ë³´</th><th>ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©</th><th>ìƒì„¸ì¡°ì¹˜ë‚´ìš©</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <table id="defect-table-fni" class="defect-table hidden">
                <thead>
                    <tr>
                        <th colspan="3">
                            <button class="download-btn" onclick="downloadCSV('fni')">CSV ë‹¤ìš´ë¡œë“œ</button>
                        </th>
                    </tr>
                    <tr><th>ì œí’ˆì •ë³´</th><th>ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©</th><th>ìƒì„¸ì¡°ì¹˜ë‚´ìš©</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <table id="defect-table-tmsm" class="defect-table hidden">
                <thead>
                    <tr>
                        <th colspan="3">
                            <button class="download-btn" onclick="downloadCSV('tmsm')">CSV ë‹¤ìš´ë¡œë“œ</button>
                        </th>
                    </tr>
                    <tr><th>ì œí’ˆì •ë³´</th><th>ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©</th><th>ìƒì„¸ì¡°ì¹˜ë‚´ìš©</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
        <div class="chart-section">
            <h2 style="text-align: center;">ğŸ† ì „ì¥ í˜‘ë ¥ì‚¬ KPI ì§€ìˆ˜</h2>
            <div class="kpi-container">
    
                <div class="kpi-card" onclick="toggleDefectTable('pns')">
                    <div class="emoji">ğŸ¥‡</div>
                    <div class="label">P&S</div>
                    <div class="tooltip" id="tooltip-pns">
                        í‰ê°€ì ìˆ˜: 10.0 / Aë“±ê¸‰<br>
                        ë¶ˆëŸ‰ê±´ìˆ˜: 1ê±´<br>
                        ëˆ„ë½ë¹„ìœ¨: 0.7%
                    </div>
                </div>
        
                <div class="kpi-card" onclick="toggleDefectTable('cna')">
                    <div class="emoji">ğŸ¥ˆ</div>
                    <div class="label">C&A</div>
                    <div class="tooltip" id="tooltip-cna">
                        í‰ê°€ì ìˆ˜: 4.8 / Bë“±ê¸‰<br>
                        ë¶ˆëŸ‰ê±´ìˆ˜: 8ê±´<br>
                        ëˆ„ë½ë¹„ìœ¨: 0.1%
                    </div>
                </div>
        
                <div class="kpi-card" onclick="toggleDefectTable('tmse')">
                    <div class="emoji">ğŸ¥‰</div>
                    <div class="label">TMS(E)</div>
                    <div class="tooltip" id="tooltip-tmse">
                        í‰ê°€ì ìˆ˜: 3.0 / Cë“±ê¸‰<br>
                        ë¶ˆëŸ‰ê±´ìˆ˜: 10ê±´<br>
                        ëˆ„ë½ë¹„ìœ¨: 0.0%
                    </div>
                </div>
        
            </div>
            <table id="defect-table-pns" class="defect-table hidden">
                <thead>
                    <tr>
                        <th colspan="3">
                            <button class="download-btn" onclick="downloadCSV('pns')">CSV ë‹¤ìš´ë¡œë“œ</button>
                        </th>
                    </tr>
                    <tr><th>ì œí’ˆì •ë³´</th><th>ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©</th><th>ìƒì„¸ì¡°ì¹˜ë‚´ìš©</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <table id="defect-table-tmse" class="defect-table hidden">
                <thead>
                    <tr>
                        <th colspan="3">
                            <button class="download-btn" onclick="downloadCSV('tmse')">CSV ë‹¤ìš´ë¡œë“œ</button>
                        </th>
                    </tr>
                    <tr><th>ì œí’ˆì •ë³´</th><th>ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©</th><th>ìƒì„¸ì¡°ì¹˜ë‚´ìš©</th></tr>
                </thead>
                <tbody></tbody>
            </table>
            <table id="defect-table-cna" class="defect-table hidden">
                <thead>
                    <tr>
                        <th colspan="3">
                            <button class="download-btn" onclick="downloadCSV('cna')">CSV ë‹¤ìš´ë¡œë“œ</button>
                        </th>
                    </tr>
                    <tr><th>ì œí’ˆì •ë³´</th><th>ìƒì„¸ë¶ˆëŸ‰ë‚´ìš©</th><th>ìƒì„¸ì¡°ì¹˜ë‚´ìš©</th></tr>
                </thead>
                <tbody></tbody>
            </table>
        </div>
    </body>
    </html>
    