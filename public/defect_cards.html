
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🏭 PDA 불량 분석 대시보드</title>
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
                 body {
             font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, sans-serif;
             background: #f8f9fa;
             min-height: 100vh;
             color: #2d3748;
         }
        
        
        
                 .container {
             max-width: 1400px;
             margin: 0 auto;
             padding: 20px;
         }
        
                 .section {
             background: white;
             border-radius: 10px;
             padding: 20px;
             margin-bottom: 20px;
             box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
             border: 1px solid #e2e8f0;
         }
        
        .section h2 {
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #2d3748;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
                 .card-container {
             display: grid;
             grid-template-columns: 1fr 1fr;
             gap: 20px;
             padding: 0;
             width: 100%;
         }
        
        
        
                          .defect-card {
             background: white;
             border-radius: 8px;
             padding: 16px;
             box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
             transition: all 0.3s ease;
             border: 1px solid #e2e8f0;
             position: relative;
             overflow: hidden;
             min-width: 0;
             width: 100%;
         }
        
        .defect-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.15);
        }
        
        .defect-card h3 {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 15px;
            color: #2d3748;
        }
        
        .defect-info {
            margin-bottom: 15px;
        }
        
                 .defect-info p {
             margin: 8px 0;
             font-size: 14px;
             color: #4a5568 !important;
             display: flex;
             justify-content: space-between;
             align-items: center;
         }
         
         .defect-count {
             font-weight: 700 !important;
             color: #e53e3e !important;
             font-size: 1.1rem !important;
         }
         
         .defect-categories {
             color: #4299e1 !important;
             font-weight: 500 !important;
         }
        
                 .detail-btn {
             display: inline-flex;
             align-items: center;
             gap: 8px;
             background: #007bff;
             color: white;
             padding: 8px 16px;
             border-radius: 6px;
             text-decoration: none;
             font-weight: 500;
             font-size: 14px;
             transition: all 0.3s ease;
             border: none;
             cursor: pointer;
         }
         
         .detail-btn:hover {
             background: #0056b3;
             transform: translateY(-1px);
         }
        
        .chart-container {
            position: relative;
            height: 500px;
            margin: 20px 0;
        }
        
        .detail-box {
            display: none;
            margin: 20px 0;
            padding: 20px;
            background: #f7fafc;
            border-radius: 15px;
            border-left: 4px solid #4299e1;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .detail-box::-webkit-scrollbar {
            width: 6px;
        }
        
        .detail-box::-webkit-scrollbar-thumb {
            background: #cbd5e0;
            border-radius: 3px;
        }
        
        .detail-row {
            margin: 8px 0;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .product-title {
            margin: 15px 0 8px 0;
            font-weight: 600;
            font-size: 15px;
            color: #2d3748;
            padding: 8px 12px;
            background: white;
            border-radius: 8px;
            border-left: 3px solid #4299e1;
        }
        
        .pagination {
            margin-top: 15px;
            text-align: center;
        }
        
        .pagination button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 8px 16px;
            margin: 0 5px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.3s ease;
        }
        
        .pagination button:hover {
            background: #3182ce;
        }
        
                 @media (max-width: 768px) {
             .container {
                 padding: 15px;
             }
             
             .card-container {
                 grid-template-columns: 1fr;
                 gap: 15px;
             }
             
             .section {
                 padding: 20px;
             }
         }
         
         @media (max-width: 1024px) and (min-width: 769px) {
             .card-container {
                 grid-template-columns: repeat(2, 1fr);
                 gap: 15px;
             }
         }
        </style>
</head>
<body>

    
    <div class="container">
        <!-- 카드 뷰 섹션 -->
        <div class="section">
            <h2>📋 제품별 불량 현황</h2>
            <div class="card-container">
                
            <div class="defect-card">
                <h3>🏭 DRAGON AB</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">2건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구작업</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 DRAGON AB DUAL</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">2건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구부품, 기구작업</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 GAIA-I</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">24건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구작업, 기구부품, 기구설계</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 GAIA-I DUAL</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">69건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구작업, 전장작업, 기구부품</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 GAIA-II</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">10건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구작업, 전장작업</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 GAIA-II DUAL</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">9건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구작업, 전장작업</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 GAIA-P</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">10건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구부품, 기구설계, 전장설계</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 GAIA-P DUAL</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">4건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구설계, 기구작업, 기구부품</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 SWS-I</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">5건</span></p>
                    <p>주요 분류: <span class="defect-categories">기구작업, 기구설계</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            <div class="defect-card">
                <h3>🏭 WET 1000</h3>
                <div class="defect-info">
                    <p>총 불량: <span class="defect-count">1건</span></p>
                    <p>주요 분류: <span class="defect-categories">전장작업</span></p>
                </div>
                <button class="detail-btn" onclick="scrollToChart()">
                    📊 상세 분석 보기
                </button>
            </div>
            
            </div>
        </div>
        
        <!-- 차트 섹션 -->
        <div class="section" id="chartSection">
            <h2>📊 대분류/중분류별 상세 분석 <small style="color: #718096;">(클릭하여 상세 정보 확인)</small></h2>
            <div class="chart-container">
                <canvas id="barChart"></canvas>
            </div>
            <div id="detailsArea"></div>
        </div>
    </div>

    <!-- 데이터 스크립트 -->
    <script id="bar-data" type="application/json">[{"bar_key": "기구부품 / 가공 불량", "count": 2, "losstime": 180.0}, {"bar_key": "기구부품 / 귀책파악 중", "count": 3, "losstime": 19.0}, {"bar_key": "기구부품 / 규격/치수 불량", "count": 1, "losstime": 75.0}, {"bar_key": "기구부품 / 용접 불량", "count": 3, "losstime": 335.0}, {"bar_key": "기구부품 / 작업환경 관리미흡", "count": 1, "losstime": 65.0}, {"bar_key": "기구부품 / 조립 오류", "count": 6, "losstime": 260.0}, {"bar_key": "기구설계 / BOM 누락", "count": 1, "losstime": 142.0}, {"bar_key": "기구설계 / BOM 수량오류", "count": 3, "losstime": 241.0}, {"bar_key": "기구설계 / P&ID 오류", "count": 1, "losstime": 14.0}, {"bar_key": "기구설계 / 도면표기 오류", "count": 8, "losstime": 916.0}, {"bar_key": "기구작업 / Seal 미흡", "count": 2, "losstime": 15.0}, {"bar_key": "기구작업 / Teflon 작업불량", "count": 25, "losstime": 161.0}, {"bar_key": "기구작업 / 검사기준 불명확", "count": 14, "losstime": 117.0}, {"bar_key": "기구작업 / 눈관리 누락", "count": 1, "losstime": 2.0}, {"bar_key": "기구작업 / 불완전 체결", "count": 26, "losstime": 124.0}, {"bar_key": "기구작업 / 재확인 누락", "count": 1, "losstime": 6.0}, {"bar_key": "기구작업 / 체결 누락", "count": 6, "losstime": 28.0}, {"bar_key": "기구작업 / 체결 오류", "count": 14, "losstime": 261.0}, {"bar_key": "전장부품 / 사양 오류", "count": 2, "losstime": 65.0}, {"bar_key": "전장설계 / BOM 수량오류", "count": 1, "losstime": 14.0}, {"bar_key": "전장설계 / 도면표기 오류", "count": 2, "losstime": 260.0}, {"bar_key": "전장작업 / 불완전 체결", "count": 2, "losstime": 21.0}, {"bar_key": "전장작업 / 오배선", "count": 7, "losstime": 98.0}, {"bar_key": "전장작업 / 오사양 장착", "count": 1, "losstime": 13.0}, {"bar_key": "전장작업 / 체결 누락", "count": 1, "losstime": 6.0}, {"bar_key": "전장작업 / 체결 오류", "count": 2, "losstime": 96.0}]</script>
    <script id="details-data" type="application/json">{"기구부품 / 가공 불량": {"GAIA-I DUAL": [["다연조 Sol 고정용 Bolt Tap 사선 체결", "현장 조치", 90.0]], "GAIA-P": [["Flow Sensor Base 고정 Tap 누락", "수정 후 입고", 90.0]]}, "기구부품 / 귀책파악 중": {"GAIA-I DUAL": [["SPEED CONTROLLER LEAK (우레탄, IN단)", "파트교체", 2.0], ["SPEED CONTROLLER LEAK (우레탄, IN단)", "파트교체", 10.0], ["SPEED CONTROLLER LEAK (우레탄, IN단)", "파트교체", 7.0]]}, "기구부품 / 규격/치수 불량": {"GAIA-I": [["Drain 배관 치수 상이로 체결 불가, Bracket 들뜸", "대체품 교체", 75.0]]}, "기구부품 / 용접 불량": {"GAIA-I DUAL": [["Inlet N2 Port 용접부 Leak", "수정 후 입고", 150.0]], "GAIA-P": [["용접부 Leak", "대체품 교체", 150.0]], "GAIA-P DUAL": [["TC 삽입부 규격 오류", "대체품 교체", 35.0]]}, "기구부품 / 작업환경 관리미흡": {"GAIA-I DUAL": [["다연조 Sol Tubing Chuck 내부 Bolt 유입", "대체품 교체", 65.0]]}, "기구부품 / 조립 오류": {"DRAGON AB DUAL": [["다연조 Sol End Cap 무두볼트 미장착", "현장 조치", 35.0]], "GAIA-I": [["1번 Heat 3Way Valve 절연저항 저하로 인한 Trip 발생", "", 0.0]], "GAIA-I DUAL": [["다연조 Sol End Cap 무두볼트 미장착", "현장 조치", 65.0], ["다연조 Sol End Cap 무두볼트 미장착", "현장 조치", 70.0]], "GAIA-P": [["Heating Valve 승온 시 Trip 발생", "", 0.0], ["Filter Body 누락", "수정 후 입고", 90.0]]}, "기구설계 / BOM 누락": {"GAIA-P": [["BOM 內 3Way Valve 코드 오류 및 Body 보온재 누락", "BOM 수정", 142.0]]}, "기구설계 / BOM 수량오류": {"GAIA-I DUAL": [["BOM 內 Hook Up Parts 수량 오류", "도면 Update", 81.0]], "GAIA-P": [["N2 Male Straight 수량 오류(정상: 1ea / BOM: 2ea)", "도면 및 BOM 수정", 118.0]], "SWS-I": [["End Clamp BOM 수량오류(도면 : 23EA, BOM: 21EA)", "BOM 수정", 42.0]]}, "기구설계 / P&ID 오류": {"GAIA-I": [["P&ID 內 PAB Sensor 이격으로인해 추가된 Valve Tag 누락", "P&ID 수정", 14.0]]}, "기구설계 / 도면표기 오류": {"GAIA-I DUAL": [["Heating Jacket 좌, 우 구분 반대 표기", "도면 수정", 373.0], ["N2 Line Regulator 고정 Bracket 누락", "도면 수정", 32.0], ["EN2 Line 미장착이나, NDU Cover 누락", "도면 수정", 13.0], ["Heating Jacket Controller 2가지 Type 입고", "도면 복구 진행", 186.0], ["Cabinet U/T Assy 內 LNG, O2 도면 정보와 BOM 상이", "도면 수정", 41.0]], "GAIA-P DUAL": [["조립도상 Gas Detector, Sol Valve 연결 시 L/R 반대 표기", "도면 수정", 156.0], ["Interface plate 실크인쇄 오류", "도면수정", 70.0]], "SWS-I": [["다연조 Solenoid Valve 고정 Hole 위치 오류", "도면 수정", 45.0]]}, "기구작업 / Seal 미흡": {"GAIA-II DUAL": [["MALE ELBOW FITTING NUT LEAK (1\", SUS, 체결이상 무)", "재체결", 5.0], ["MALE CONNECTOR TEFLON부 LEAK (NPT3/8, PVDF, 체결이상 무)", "Teflon 작업", 10.0]]}, "기구작업 / Teflon 작업불량": {"DRAGON AB": [["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "재체결", 4.0]], "GAIA-I": [["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "재작업", 25.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "재체결", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 4.0], ["MALE ELBOW Fitting nut Water Leak (TEFLON)", "재체결", 6.0]], "GAIA-I DUAL": [["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "재체결", 6.0], ["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 체결이상 무)", "재체결", 6.0], ["MALE CONNECTOR TEFLON부 LEAK (NPT3/8, PP, 체결이상 무)", "재작업", 2.0]], "GAIA-II": [["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 6.0]], "GAIA-P": [["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "TEFLON 작업", 6.0], ["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "TEFLON 작업", 6.0]], "GAIA-P DUAL": [["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 체결이상 무)", "Teflon 작업", 6.0]]}, "기구작업 / 검사기준 불명확": {"GAIA-I": [["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 삽입부족)", "재체결", 6.0], ["MALE ADAPTER LOCTITE부 LEAK(PT3/8, IN단, 체결이상 무)", "재체결", 25.0], ["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 삽입부족)", "재체결", 6.0], ["PORT TOP 흔들림", "재체결", 3.0], ["SPEED CONTROLLER LEAK (PFA, OUT단)", "파트교체", 5.0]], "GAIA-I DUAL": [["MALE CONNECTOR TEFLON부 LEAK (NPT1/2, PVDF, 체결이상 무)", "Teflon 작업", 14.0], ["PUMP NUT LEAK (25A, PP, 체결이상 무)", "재체결", 6.0], ["MALE CONNECTOR FITTING NUT LEAK (1/4\", PP, 체결이상 무)", "재체결", 2.0]], "GAIA-II": [["데이터를 검색하는 중입니다. 잠시 기다린 후 다시 자르거나 복사해 보세요.", "재체결", 11.0], ["SPEED CONTROLLER BODY LEAK", "파트교체", 10.0], ["SPRINKLER TEFLON부 LEAK (체결이상 무)", "Teflon 작업", 10.0]], "SWS-I": [["MALE ELBOW TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 11.0], ["UNION TEE FITTING NUT LEAK (3/8\", PVDF, 체결이상 무, 하단부)", "재조립", 4.0], ["MALE ELBOW FITTING NUT LEAK (3/8\", PVDF, 체결이상 무)", "재조립", 4.0]]}, "기구작업 / 눈관리 누락": {"GAIA-I DUAL": [["COCK VALVE MEDAL 누락 (PVC, 1/4\")", "식별 조치", 2.0]]}, "기구작업 / 불완전 체결": {"GAIA-I": [["BULKHEAD UNION FITTING NUT LEAK (3/4\", OUT단, 미완체결)", "재체결", 4.0], ["NUT LEAK (PP, 1/4\", 미완체결)", "재체결", 10.0]], "GAIA-I DUAL": [["UNION ELBOW FITTING NUT LEAK (3/8\", SUS, IN, 미완체결)", "제체결", 2.0], ["MALE CONNECTOR FITTING NUT LEAK (3/4\", SUS, 미완체결)", "재체결", 2.0], ["UNION ELBOW FITTING NUT LEAK (3/8\", SUS, IN, 미완체결)", "재체결", 3.0], ["ADJUSTABLE ELBOW FITTING NUT LEAK (1/4\", OUT단, 미완체결)", "재체결", 4.0], ["BULKHEAD UNION FITTING NUT LEAK (3/4\", OUT단, 체결불량)", "재체결", 6.0], ["UNION TEE FITTING NUT LEAK (3/4\", SUS, 미완체결, 우측상단)", "재체결", 2.0], ["REDUCING UNION TEE FITTING NUT LEAK (3/8\", SUS, 미완체결, 좌측상단)", "재체결", 2.0], ["UNION TEE FITTING NUT LEAK (1/2\", SUS, 미완체결, 하단부)", "재체결", 8.0], ["UNION ELBOW FITTING NUT LEAK (3/8\", SUS, IN, 미완체결)", "재체결", 3.0], ["MALE ELBOW FITTING NUT LEAK (3/4\", SUS, 미완체결)", "재체결", 3.0], ["BULKHEAD UNION FITTING NUT LEAK (3/8\", IN단, 미완체결)", "재체결", 2.0], ["NUT LEAK (PP, 1/4\", 체결불량)", "재체결", 10.0], ["VCR FLEXIBLE TUBE LEAK(650L,OUT단,체결강도부족)", "재체결", 2.0], ["ADJUSTABLE ELBOW FITTING NUT LEAK (3/4\", IN단, 미완체결)", "재체결", 2.0], ["CIR WATER FILTER 체결부 LEAK(PP/체결강도부족)", "재체결", 3.0], ["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 체결이상 무)", "재체결", 4.0], ["CIR WATER FILTER 체결부 LEAK(PP/체결이상무)", "재체결", 3.0], ["MALE CONNECTOR TEFLON부 LEAK (NPT1/4, PVDF, 체결이상 무)", "Teflon 작업", 8.0]], "GAIA-II": [["MALE CONNECTOR FITTING NUT LEAK (3/4\", SUS, 미완체결)", "재체결", 6.0], ["MALE CONNECTOR FITTING NUT LEAK (3/4\", SUS, 미완체결)", "재체결", 6.0]], "GAIA-II DUAL": [["MALE CONNECTOR FITTING NUT LEAK (1/4\", SUS, 미완체결)", "재체결", 4.0], ["O-RING 씹힘 (PVC, EPDM, 125A, BLK)", "재작업", 18.0], ["MALE PIPE WELD CONNECTOR FITTING NUT LEAK (1/4\", SUS, 미완체결)", "재체결", 2.0], ["UNION NUT LEAK (25A, PP, 미완체결)", "재체결", 5.0]]}, "기구작업 / 재확인 누락": {"GAIA-I DUAL": [["PORT TOP 흔들림", "재체결", 6.0]]}, "기구작업 / 체결 누락": {"GAIA-I DUAL": [["UNION ELBOW FITTING NUT LEAK (6mm, SUS, IN, 미완체결)", "재체결", 6.0], ["MALE STRAIGHT LEAK (6mm, PT1/4\", PFA, 미삽입)", "재체결", 3.0], ["UNION ELBOW FITTING NUT LEAK (6mm, SUS, IN, FERRULE 물림X)", "재체결", 2.0], ["UNION NUT LEAK (20A, PP, O-RING 이탈)", "재조립", 13.0]], "GAIA-II DUAL": [["BULKHEAD UNION LEAK (6mm, 우레탄, IN단, 미삽입)", "재체결", 2.0], ["BULKHEAD UNION LEAK (6mm, 우레탄, IN단, 미삽입)", "재체결", 2.0]]}, "기구작업 / 체결 오류": {"DRAGON AB": [["FLOW SENSOR 과체결로인한 파손", "재조립", 18.0]], "DRAGON AB DUAL": [["PNEUMATIC VALVE LEAK(3/8\", STS, 체결불량)", "재체결", 10.0]], "GAIA-I DUAL": [["125A CLAMP 체결불량 (알류미늄/사선체결)", "재체결", 10.0], ["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 체결이상 무)", "재체결", 11.0], ["역방향 조립으로 인한 Flow 불가", "재작업", 50.0], ["O-RING 씹힘 (PVC, EPDM, 125A, BLK)", "재장착", 6.0], ["케이블 오배선", "재작업", 2.0], ["O-RING 씹힘 (PVC, EPDM, 125A, BLK)", "재체결", 15.0], ["MALE BANJO 삽입튜브 오조립 (우레탄, 10mm, IN/OUT단 교차 연결)", "재작업", 12.0], ["O2 Line Pneumatic Valve Open 불가", "역방향 체결", 40.0], ["MALE CONNECTOR FITTING NUT LEAK (1/2\", PVDF, 체결이상 무)", "재체결", 7.0], ["NW 50 CLAMP 체결불량 (알류미늄/사선체결)", "재체결", 9.0]], "GAIA-II": [["MALE ELBOW FITTING NUT LEAK (1/2\", PVDF, 삽입부족)", "재체결", 6.0], ["FEMALE ADAPTER LOCTITE부 LEAK(PT1/2, OUT단, 나사선 마모)", "재조립", 65.0]]}, "전장부품 / 사양 오류": {"GAIA-I DUAL": [["Heating Jacket Label 미부착", "현장 조치", 25.0], ["Heating Jacket Cable +, - 오배선", "현장 조치", 40.0]]}, "전장설계 / BOM 수량오류": {"GAIA-P": [["MC Cover BOM 수량 오류(정상: 2ea / 오류: 1ea)", "BOM 수정", 14.0]]}, "전장설계 / 도면표기 오류": {"GAIA-I DUAL": [["Inlet Scraper 전장 도면 표기 오류(정상: SCR120 / 오류: SCR110)", "도면 수정", 93.0]], "GAIA-P": [["도면 內 Leak Film 규격 오류(정상: 800mm / 오류: 600mm)", "도면 수정", 167.0]]}, "전장작업 / 불완전 체결": {"GAIA-I DUAL": [["MALE CONNECTOR FITTING NUT WATER LEAK (NUT부,1/4\")", "재체결", 6.0], ["Right Chamber Ignition 불가", "Cable 재작업 후 정상 동작", 15.0]]}, "전장작업 / 오배선": {"GAIA-I DUAL": [["케이블 오배선", "재작업", 16.0], ["Sol Valve(SV420 ↔ SV850)", "재작업", 35.0], ["케이블 오배선 (교차)", "재작업", 8.0], ["케이블 오배선", "재작업", 8.0], ["케이블 오배선", "재작업", 8.0], ["케이블 오배선 (교차)", "재작업", 15.0]], "WET 1000": [["케이블 오배선(교차)", "재작업", 8.0]]}, "전장작업 / 오사양 장착": {"GAIA-II DUAL": [["NOISE FILTER 사양불량", "재작업", 13.0]]}, "전장작업 / 체결 누락": {"GAIA-II": [["MALE PIPE WELD CONNECTOR FITTING NUT LEAK (1/4\", RTD SENSOR 체결부, 미완체결)", "재체결", 6.0]]}, "전장작업 / 체결 오류": {"GAIA-I DUAL": [["MALE CONNECTOR FITTING NUT WATER LEAK (NUT부,1/4\")", "재체결", 6.0], ["Burning시 LNG Flow 10LPM 도달 후 유지되지 못하고 Main Flame Off 발생", "SV420, SV850 바뀌어 장착해 재작업하여 조치", 90.0]]}}</script>

    <script>
        // 스크롤 함수
        function scrollToChart() {
            document.getElementById('chartSection').scrollIntoView({
                behavior: 'smooth'
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            // Chart.js 로드 확인
            if (typeof Chart === 'undefined') {
                document.getElementById('detailsArea').innerHTML = 
                    '<div class="detail-box" style="display: block;">❌ Chart.js 로드 실패</div>';
                return;
            }

            // JSON 데이터 읽기
            const barData = JSON.parse(document.getElementById('bar-data').textContent);
            const detailsDict = JSON.parse(document.getElementById('details-data').textContent);

            const labels = barData.map(r => r['bar_key']);
            const counts = barData.map(r => r['count']);

            // Canvas 확인
            const ctx = document.getElementById('barChart').getContext('2d');
            if (!ctx) {
                document.getElementById('detailsArea').innerHTML = 
                    '<div class="detail-box" style="display: block;">❌ 차트 렌더링 실패</div>';
                return;
            }

            // 차트 초기화
            const myChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '불량 건수',
                        data: counts,
                        backgroundColor: 'rgba(102, 126, 234, 0.8)',
                        borderColor: 'rgba(102, 126, 234, 1)',
                        borderWidth: 1,
                        borderRadius: 8,
                        borderSkipped: false,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    onClick: (evt, el) => {
                        if (el.length > 0) {
                            const idx = el[0].index;
                            const key = labels[idx];
                            showDetail(key, labels[idx]);
                        }
                    },
                    plugins: {
                        legend: { 
                            display: false 
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleColor: 'white',
                            bodyColor: 'white',
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    const idx = context.dataIndex;
                                    const count = context.raw;
                                    const losstime = barData[idx].losstime;
                                    let tooltip = `불량 건수: ${count}건`;
                                    if (losstime > 0) {
                                        tooltip += `\nLoss Time: ${losstime}분`;
                                    }
                                    return tooltip;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                autoSkip: false, 
                                maxRotation: 45, 
                                minRotation: 0,
                                font: { 
                                    size: 11,
                                    family: 'Pretendard'
                                },
                                color: '#4a5568'
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            beginAtZero: true,
                            ticks: {
                                font: {
                                    size: 11,
                                    family: 'Pretendard'
                                },
                                color: '#4a5568'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            }
                        }
                    }
                }
            });

            function showDetail(key, label, page = 1, perPage = 10) {
                const area = document.getElementById('detailsArea');
                if (!(key in detailsDict)) {
                    area.innerHTML = `<div class="detail-box" style="display: block;">❌ 데이터가 없습니다: ${label}</div>`;
                    return;
                }

                const prodMap = detailsDict[key];
                let prodKeys = Object.keys(prodMap);
                const start = (page - 1) * perPage;
                const end = start + perPage;
                
                let html = `<div class="detail-box"><strong>📋 상세 정보: ${label}</strong><br><br>`;
                
                prodKeys.slice(start, end).forEach(prod => {
                    html += `<div class="product-title">🔹 ${prod}</div>`;
                    const plist = prodMap[prod];
                    if (plist.length === 0) {
                        html += '<div class="detail-row">데이터 없음</div>';
                    } else {
                        plist.forEach(row => {
                            let detail = `▪️ ${row[0]} / <span style="color:#666;">${row[1]}</span>`;
                            if (row[2] > 0) {
                                detail += ` / <span style="color:#e53e3e; font-weight: 600;">${row[2]}분</span>`;
                            }
                            html += `<div class="detail-row">${detail}</div>`;
                        });
                    }
                });

                if (prodKeys.length > perPage) {
                    html += `<div class="pagination">`;
                    if (page > 1) {
                        html += `<button onclick="showDetail('${key}', '${label}', ${page - 1})">← 이전</button>`;
                    }
                    html += `<span style="margin: 0 10px; color: #666;">페이지 ${page} / ${Math.ceil(prodKeys.length / perPage)}</span>`;
                    if (end < prodKeys.length) {
                        html += `<button onclick="showDetail('${key}', '${label}', ${page + 1})">다음 →</button>`;
                    }
                    html += `</div>`;
                }
                
                html += '</div>';
                area.innerHTML = html;
                document.querySelector('.detail-box').style.display = "block";
                
                // 상세 정보로 스크롤
                document.querySelector('.detail-box').scrollIntoView({
                    behavior: 'smooth'
                });
            }

            // 전역 함수로 등록
            window.showDetail = showDetail;
        });
    </script>
</body>
</html>
        